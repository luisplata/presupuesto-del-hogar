(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(1576)}])},1576:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return tc}});var r=a(85893),s=a(67294),l=a(1604),o=a(56312),n=a(87536),i=a(88426),d=a(12003),c=a(53776);let m=(0,d.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:o=!1,...n}=e,d=o?i.g7:"button";return(0,r.jsx)(d,{className:(0,c.cn)(m({variant:s,size:l,className:a})),ref:t,...n})});u.displayName="Button";var x=a(49102);let p=(0,d.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(x.f,{ref:t,className:(0,c.cn)(p(),a),...s})});f.displayName=x.f.displayName;let h=n.RV,g=s.createContext({}),j=e=>{let{...t}=e;return(0,r.jsx)(g.Provider,{value:{name:t.name},children:(0,r.jsx)(n.Qr,{...t})})},v=()=>{let e=s.useContext(g),t=s.useContext(y),{getFieldState:a,formState:r}=(0,n.Gc)(),l=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...l}},y=s.createContext({}),N=s.forwardRef((e,t)=>{let{className:a,...l}=e,o=s.useId();return(0,r.jsx)(y.Provider,{value:{id:o},children:(0,r.jsx)("div",{ref:t,className:(0,c.cn)("space-y-2",a),...l})})});N.displayName="FormItem";let b=s.forwardRef((e,t)=>{let{className:a,...s}=e,{error:l,formItemId:o}=v();return(0,r.jsx)(f,{ref:t,className:(0,c.cn)(l&&"text-destructive",a),htmlFor:o,...s})});b.displayName="FormLabel";let w=s.forwardRef((e,t)=>{let{...a}=e,{error:s,formItemId:l,formDescriptionId:o,formMessageId:n}=v();return(0,r.jsx)(i.g7,{ref:t,id:l,"aria-describedby":s?"".concat(o," ").concat(n):"".concat(o),"aria-invalid":!!s,...a})});w.displayName="FormControl",s.forwardRef((e,t)=>{let{className:a,...s}=e,{formDescriptionId:l}=v();return(0,r.jsx)("p",{ref:t,id:l,className:(0,c.cn)("text-sm text-muted-foreground",a),...s})}).displayName="FormDescription";let k=s.forwardRef((e,t)=>{var a;let{className:s,children:l,...o}=e,{error:n,formMessageId:i}=v(),d=n?String(null!==(a=null==n?void 0:n.message)&&void 0!==a?a:""):l;return d?(0,r.jsx)("p",{ref:t,id:i,className:(0,c.cn)("text-sm font-medium text-destructive",s),...o,children:d}):null});k.displayName="FormMessage";let C=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});C.displayName="Input";var S=a(31987),E=a(78056),D=a(39784),R=a(37888),_=a(16045),T=a(42932),F=a(69508),P=a(10524),V=a(71371),M=a(61551),I=a(55869),z=a(52688);let G=e=>{if(e instanceof Date&&(0,E.J)(e))return e;if("string"==typeof e){let t=(0,D.D)(e);if((0,E.J)(t))return t}if("number"==typeof e){let t=new Date(e);if((0,E.J)(t))return t}return null},O=(e,t)=>{let a,r;let s=new Date;switch(t){case"week":a=(0,R.z)(s,{weekStartsOn:1}),r=(0,_.v)(s,{weekStartsOn:1});break;case"month":a=(0,T.N)(s),r=(0,F.V)(s);break;case"bi-weekly":let l=(0,T.N)(s),o=(0,F.V)(s),n=(0,P.i)(new Date(s.getFullYear(),s.getMonth(),15));s<=n?(a=(0,V.b)(l),r=n):(a=(0,V.b)(new Date(s.getFullYear(),s.getMonth(),16)),r=(0,P.i)(o));break;default:return[]}return a=(0,V.b)(a),r=(0,P.i)(r),e.filter(e=>{let t=G(e.timestamp);return t&&(0,M._)(t,{start:a,end:r})})},K=e=>e.reduce((e,t)=>e+(t.price||0),0),L=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}),A=e=>((null==e||isNaN(e))&&(e=0),L.format(e)),H=e=>{if(null==e)return 0;let t=parseInt(String(e).replace(/[^\d]/g,""),10);return isNaN(t)?0:t},Z=e=>{let t=G(e);if(!t)return"Fecha inv\xe1lida";let a=z.es;try{return(0,I.WU)(t,"PPpp",{locale:a})}catch(a){return console.error("Error formatting date:",a,"Input:",e,"Parsed:",t),t.toLocaleDateString("es-ES")+" "+t.toLocaleTimeString("es-ES")}},Y=()=>l.Ry({product:l.Z_().min(1,{message:"El nombre del producto no puede estar vac\xedo."}),price:l.oQ.number().positive({message:"El precio debe ser un n\xfamero positivo."}),category:l.Z_().optional()});function B(e){let{onAddExpense:t,categories:a,defaultCategoryKey:l}=e,{toast:i}=(0,S.pm)(),[d,c]=(0,s.useState)(!1),[m,x]=(0,s.useState)(""),p=(0,s.useMemo)(()=>Y(),[]),f=(0,n.cI)({resolver:(0,o.F)(p),defaultValues:{product:"",price:0,category:""}}),g=f.watch("price");(0,s.useEffect)(()=>{"number"!=typeof g||isNaN(g)?x(A(0)):x(A(g))},[g]);let v=(e,t)=>{let a=H(e.target.value);x(A(isNaN(a)?0:a)),t(isNaN(a)?0:a)},y=(e,t)=>{x(A(isNaN(t)?0:t)),e()};async function E(e){c(!0);try{var a;let r=(null===(a=e.category)||void 0===a?void 0:a.trim())||l;await new Promise(e=>setTimeout(e,100)),t({product:{name:e.product,color:"",value:0},price:e.price,category:r}),i({title:"Gasto agregado",description:"Producto: ".concat(e.product,", Precio: ").concat(A(e.price),", Categor\xeda: ").concat(r)}),f.reset({product:"",price:0,category:""}),x(A(0))}catch(e){console.error("Error al agregar gasto:",e),i({title:"Error",description:"No se pudo agregar el gasto.",variant:"destructive"})}finally{c(!1)}}return(0,r.jsx)(h,{...f,children:(0,r.jsxs)("form",{onSubmit:f.handleSubmit(E),className:"space-y-3 sm:space-y-4 rounded-lg border bg-card p-4 sm:p-6 shadow-sm",children:[(0,r.jsx)(j,{control:f.control,name:"product",render:e=>{let{field:t}=e;return(0,r.jsxs)(N,{children:[(0,r.jsx)(b,{className:"text-xs sm:text-sm",children:"Producto"}),(0,r.jsx)(w,{children:(0,r.jsx)(C,{placeholder:"Ej: Caf\xe9",...t})}),(0,r.jsx)(k,{})]})}}),(0,r.jsx)(j,{control:f.control,name:"price",render:e=>{let{field:t}=e;return(0,r.jsxs)(N,{children:[(0,r.jsx)(b,{className:"text-xs sm:text-sm",children:"Precio (COP)"}),(0,r.jsx)(w,{children:(0,r.jsx)(C,{type:"text",placeholder:A(0),...t,value:m,onChange:e=>v(e,t.onChange),onBlur:()=>y(t.onBlur,t.value),inputMode:"decimal"})}),(0,r.jsx)(k,{})]})}}),(0,r.jsx)(j,{control:f.control,name:"category",render:e=>{let{field:t}=e;return(0,r.jsxs)(N,{children:[(0,r.jsx)(b,{className:"text-xs sm:text-sm",children:"Categor\xeda (Opcional)"}),(0,r.jsx)(w,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C,{placeholder:"Ej: Comida",...t,list:"category-suggestions",autoComplete:"off"}),(0,r.jsx)("datalist",{id:"category-suggestions",children:a.map(e=>(0,r.jsx)("option",{value:e},e))})]})}),(0,r.jsx)(k,{})]})}}),(0,r.jsx)(u,{type:"submit",disabled:d,className:"w-full sm:w-auto",children:d?"Agregando...":"Agregar Gasto"})]})})}let U=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});U.displayName="Card";let W=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",a),...s})});W.displayName="CardHeader";let J=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});J.displayName="CardTitle";let Q=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...s})});Q.displayName="CardDescription";let $=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,c.cn)("p-6 pt-0",a),...s})});$.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter";var q=a(31702);let X=q.fC,ee=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(q.aV,{ref:t,className:(0,c.cn)("inline-flex h-auto min-h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s})});ee.displayName=q.aV.displayName;let et=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(q.xz,{ref:t,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s})});et.displayName=q.xz.displayName;let ea=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(q.VY,{ref:t,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});function er(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-muted",t),...a})}function es(e){let{expenses:t}=e,[a,l]=(0,s.useState)(!1),[o,n]=(0,s.useState)(null),[i,d]=(0,s.useState)(null),[c,m]=(0,s.useState)(null),[u,x]=(0,s.useState)(0),[p,f]=(0,s.useState)(0),[h,g]=(0,s.useState)(0);(0,s.useEffect)(()=>{l(!0);let e=O(t,"week"),a=O(t,"bi-weekly"),r=O(t,"month");n(K(e)),d(K(a)),m(K(r)),x(e.length),f(a.length),g(r.length)},[t]);let j=e=>{let t,s,l,n;switch(e){case"week":t=o,s=u,l="Total Gastado esta Semana",n="semana";break;case"bi-weekly":t=i,s=p,l="Total Gastado esta Quincena",n="quincena";break;case"month":t=c,s=h,l="Total Gastado este Mes",n="mes"}return a&&null!==t?(0,r.jsxs)("div",{className:"mt-4 p-3 sm:p-4 rounded-md border bg-card",children:[" ",(0,r.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:l})," ",(0,r.jsx)("p",{className:"text-xl sm:text-2xl font-bold text-primary",children:A(t)})," ",(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[s," gasto(s) esta ",n,"."]})," "]}):(0,r.jsxs)("div",{className:"mt-4 p-3 sm:p-4 rounded-md border bg-card space-y-2",children:[" ",(0,r.jsx)(er,{className:"h-5 sm:h-6 w-3/4"}),(0,r.jsx)(er,{className:"h-7 sm:h-8 w-1/2"}),(0,r.jsx)(er,{className:"h-4 w-1/4"})]})};return(0,r.jsxs)(U,{children:[(0,r.jsx)(W,{className:"px-4 py-3 sm:px-6 sm:py-4",children:(0,r.jsx)(J,{className:"text-lg sm:text-xl",children:a?"Resumen de Gastos":(0,r.jsx)(er,{className:"h-6 w-1/2"})})}),(0,r.jsx)($,{className:"px-4 pb-4 sm:px-6 sm:pb-6",children:(0,r.jsxs)(X,{defaultValue:"week",className:"w-full",children:[(0,r.jsxs)(ee,{className:"grid w-full grid-cols-3 h-auto text-xs sm:text-sm",children:[" ",a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(et,{value:"week",className:"py-1.5 sm:py-2",children:"Semana"})," ",(0,r.jsx)(et,{value:"bi-weekly",className:"py-1.5 sm:py-2",children:"Quincena"})," ",(0,r.jsx)(et,{value:"month",className:"py-1.5 sm:py-2",children:"Mes"})," "]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(er,{className:"h-9 w-full"}),(0,r.jsx)(er,{className:"h-9 w-full"}),(0,r.jsx)(er,{className:"h-9 w-full"})]})]}),(0,r.jsx)(ea,{value:"week",children:j("week")}),(0,r.jsx)(ea,{value:"bi-weekly",children:j("bi-weekly")}),(0,r.jsx)(ea,{value:"month",children:j("month")})]})})]})}ea.displayName=q.VY.displayName;let el=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{ref:t,className:(0,c.cn)("w-full caption-bottom text-sm",a),...s})})});el.displayName="Table";let eo=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("thead",{ref:t,className:(0,c.cn)("[&_tr]:border-b",a),...s})});eo.displayName="TableHeader";let en=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,c.cn)("[&_tr:last-child]:border-0",a),...s})});en.displayName="TableBody",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s})}).displayName="TableFooter";let ei=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tr",{ref:t,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});ei.displayName="TableRow";let ed=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("th",{ref:t,className:(0,c.cn)("h-10 sm:h-12 px-2 sm:px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 whitespace-nowrap",a),...s})});ed.displayName="TableHead";let ec=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("td",{ref:t,className:(0,c.cn)("p-2 sm:p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});ec.displayName="TableCell";let em=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("caption",{ref:t,className:(0,c.cn)("mt-4 text-xs sm:text-sm text-muted-foreground px-2 sm:px-4",a),...s})});em.displayName="TableCaption";var eu=a(73260),ex=a(90682);let ep=ex.fC,ef=ex.xz,eh=ex.h_,eg=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ex.aV,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});eg.displayName=ex.aV.displayName;let ej=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsxs)(eh,{children:[(0,r.jsx)(eg,{}),(0,r.jsx)(ex.VY,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]})});ej.displayName=ex.VY.displayName;let ev=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};ev.displayName="AlertDialogHeader";let ey=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};ey.displayName="AlertDialogFooter";let eN=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ex.Dx,{ref:t,className:(0,c.cn)("text-lg font-semibold",a),...s})});eN.displayName=ex.Dx.displayName;let eb=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ex.dk,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...s})});eb.displayName=ex.dk.displayName;let ew=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ex.aU,{ref:t,className:(0,c.cn)(m(),a),...s})});ew.displayName=ex.aU.displayName;let ek=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ex.$j,{ref:t,className:(0,c.cn)(m({variant:"outline"}),"mt-2 sm:mt-0",a),...s})});ek.displayName=ex.$j.displayName;let eC=(0,d.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eS(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,c.cn)(eC({variant:a}),t),...s})}function eE(e){let{expenses:t,title:a,caption:s,onDeleteExpense:l,groupName:o,groupDisplayName:n,onDeleteGroup:i,groupTypeLabel:d,defaultCategoryKey:c}=e,{toast:m}=(0,S.pm)(),x=null!=a?a:"Historial de Gastos",p="Grupo",f=e=>{l(e),m({title:"Gasto eliminado",description:"El gasto ha sido eliminado exitosamente."})},h=e=>{i&&(i(e),m({title:"".concat(d||p," eliminado"),description:'Todas las entradas para "'.concat(n||e,'" han sido eliminadas.')}))};if(!t||0===t.length)return(0,r.jsxs)(U,{children:[(0,r.jsx)(W,{children:(0,r.jsx)(J,{children:x})}),(0,r.jsxs)($,{children:[(0,r.jsx)("p",{className:"text-muted-foreground text-center p-4",children:"No hay gastos para mostrar."})," "]})]});let g=!!i&&!!o;return(0,r.jsxs)(U,{children:[(0,r.jsxs)(W,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 px-4 py-3 sm:px-6 sm:py-4",children:[(0,r.jsx)(J,{className:"text-lg sm:text-xl",children:x}),g&&o&&(0,r.jsxs)(ep,{children:[(0,r.jsx)(ef,{asChild:!0,children:(0,r.jsxs)(u,{variant:"destructive",size:"sm",className:"w-full sm:w-auto",children:[(0,r.jsx)(eu.Z,{className:"mr-2 h-4 w-4"})," Eliminar ",d," (",n||o,")"]})}),(0,r.jsxs)(ej,{children:[(0,r.jsxs)(ev,{children:[(0,r.jsx)(eN,{children:"\xbfEst\xe1s seguro?"}),(0,r.jsxs)(eb,{children:["Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente todas las entradas para ",(null==d?void 0:d.toLowerCase())||p.toLowerCase(),' "',n||o,'".']})]}),(0,r.jsxs)(ey,{children:[(0,r.jsx)(ek,{children:"Cancelar"}),(0,r.jsxs)(ew,{onClick:()=>h(o),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:["Eliminar ",d]})]})]})]})]}),(0,r.jsx)($,{className:"px-0 sm:px-6 sm:pb-4",children:(0,r.jsxs)(el,{children:[(0,r.jsx)(em,{className:"px-4 sm:px-6 py-2 text-xs sm:text-sm",children:null!=s?s:"Lista de todos tus gastos."}),(0,r.jsx)(eo,{children:(0,r.jsxs)(ei,{children:[(0,r.jsx)(ed,{className:"px-2 py-2 sm:px-4",children:"Producto"}),(0,r.jsx)(ed,{className:"px-2 py-2 sm:px-4",children:"Precio"}),(0,r.jsx)(ed,{className:"hidden md:table-cell px-2 py-2 sm:px-4",children:"Categor\xeda"}),(0,r.jsx)(ed,{className:"hidden lg:table-cell px-2 py-2 sm:px-4",children:"Fecha y Hora"}),(0,r.jsx)(ed,{className:"text-right px-2 py-2 sm:px-4",children:"Acciones"})]})}),(0,r.jsx)(en,{children:t.sort((e,t)=>{var a,r,s,l;let o=null!==(s=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==s?s:0;return(null!==(l=null===(r=G(t.timestamp))||void 0===r?void 0:r.getTime())&&void 0!==l?l:0)-o}).map(e=>(0,r.jsxs)(ei,{children:[(0,r.jsx)(ec,{className:"font-medium px-2 py-2 sm:px-4 truncate max-w-[100px] sm:max-w-xs",children:e.product.name}),(0,r.jsx)(ec,{className:"px-2 py-2 sm:px-4 whitespace-nowrap",children:A(e.price)}),(0,r.jsx)(ec,{className:"hidden md:table-cell px-2 py-2 sm:px-4",children:(0,r.jsxs)(eS,{variant:e.category===c?"secondary":"outline",className:"text-xs",children:[e.category," "]})}),(0,r.jsx)(ec,{className:"hidden lg:table-cell px-2 py-2 sm:px-4 whitespace-nowrap",children:Z(e.timestamp)})," ",(0,r.jsx)(ec,{className:"text-right px-2 py-2 sm:px-4",children:(0,r.jsxs)(ep,{children:[(0,r.jsx)(ef,{asChild:!0,children:(0,r.jsxs)(u,{variant:"ghost",size:"icon",children:[(0,r.jsx)(eu.Z,{className:"h-4 w-4 text-destructive"}),(0,r.jsx)("span",{className:"sr-only",children:"Eliminar"})]})}),(0,r.jsxs)(ej,{children:[(0,r.jsxs)(ev,{children:[(0,r.jsx)(eN,{children:"\xbfEst\xe1s seguro?"}),(0,r.jsxs)(eb,{children:['Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente el gasto "',e.product.name,'" con precio ',A(e.price),"."]})]}),(0,r.jsxs)(ey,{children:[(0,r.jsx)(ek,{children:"Cancelar"}),(0,r.jsx)(ew,{onClick:()=>f(e.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar Gasto"})]})]})]})})]},e.id))})]})})]})}var eD=a(97566),eR=a(54046),e_=a(56169),eT=a(81670);let eF=eD.fC;eD.ZA;let eP=eD.B4,eV=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(eD.xz,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[s,(0,r.jsx)(eD.JO,{asChild:!0,children:(0,r.jsx)(eR.Z,{className:"h-4 w-4 opacity-50"})})]})});eV.displayName=eD.xz.displayName;let eM=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eD.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(e_.Z,{className:"h-4 w-4"})})});eM.displayName=eD.u_.displayName;let eI=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eD.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(eR.Z,{className:"h-4 w-4"})})});eI.displayName=eD.$G.displayName;let ez=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...o}=e;return(0,r.jsx)(eD.h_,{children:(0,r.jsxs)(eD.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...o,children:[(0,r.jsx)(eM,{}),(0,r.jsx)(eD.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(eI,{})]})})});ez.displayName=eD.VY.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eD.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=eD.__.displayName;let eG=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(eD.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(eD.wU,{children:(0,r.jsx)(eT.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(eD.eT,{children:s})]})});eG.displayName=eD.ck.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eD.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=eD.Z0.displayName;let eO=e=>["all",...Array.from(new Set(e.map(e=>e.product.name))).sort()],eK=(e,t)=>"all"===t?e:e.filter(e=>e.product.name===t);function eL(e){let{expenses:t,onDeleteExpense:a,onDeleteProduct:l,defaultCategoryKey:o}=e,[n,i]=(0,s.useState)("all"),d=(0,s.useMemo)(()=>eO(t),[t]),c=(0,s.useMemo)(()=>eK(t,n),[t,n]),m=(0,s.useCallback)(e=>{void 0!==e&&i(e)},[]),u="all"===n?"Todos los Productos":n,x="all"===n?"Historial Completo por Producto":"Historial de ".concat(n),p="all"===n?"Todos los gastos registrados.":"Gastos registrados para ".concat(n,".");return(0,r.jsxs)(U,{children:[(0,r.jsx)(W,{className:"px-4 py-3 sm:px-6 sm:py-4",children:(0,r.jsx)(J,{className:"text-lg sm:text-xl",children:"Historial por Producto"})}),(0,r.jsxs)($,{className:"space-y-4 px-4 pb-4 sm:px-6 sm:pb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(f,{htmlFor:"product-select",className:"text-xs sm:text-sm",children:"Seleccionar Producto:"}),(0,r.jsxs)(eF,{onValueChange:m,value:n,children:[(0,r.jsx)(eV,{id:"product-select",className:"w-full mt-1",children:(0,r.jsx)(eP,{placeholder:"Seleccionar Producto",children:u})}),(0,r.jsx)(ez,{children:d.map(e=>(0,r.jsx)(eG,{value:e,children:"all"===e?"Todos los Productos":e},e))})]})]}),(0,r.jsx)(eE,{expenses:c,onDeleteExpense:a,groupName:"all"!==n?n:void 0,onDeleteGroup:"all"!==n?l:void 0,groupTypeLabel:"all"!==n?"Producto":void 0,groupDisplayName:"all"!==n?n:void 0,title:x,caption:p,defaultCategoryKey:o})]})]})}let eA=(e,t)=>["all",...Array.from(new Set(e.map(e=>e.category||t))).sort()],eH=(e,t,a)=>"all"===t?e:e.filter(e=>(e.category||a)===t);function eZ(e){let{expenses:t,onDeleteExpense:a,onDeleteCategory:l,defaultCategoryKey:o}=e,[n,i]=(0,s.useState)("all"),d=(0,s.useMemo)(()=>eA(t,o),[t,o]),c=(0,s.useMemo)(()=>eH(t,n,o),[t,n,o]),m=(0,s.useCallback)(e=>{void 0!==e&&i(e)},[]),u="all"===n?"Todas las Categor\xedas":n,x="all"===n?"Historial Completo por Categor\xeda":"Historial de ".concat(u),p="all"===n?"Todos los gastos registrados.":"Gastos registrados para la categor\xeda ".concat(u,".");return(0,r.jsxs)(U,{children:[(0,r.jsx)(W,{className:"px-4 py-3 sm:px-6 sm:py-4",children:(0,r.jsx)(J,{className:"text-lg sm:text-xl",children:"Historial por Categor\xeda"})}),(0,r.jsxs)($,{className:"space-y-4 px-4 pb-4 sm:px-6 sm:pb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(f,{htmlFor:"category-select",className:"text-xs sm:text-sm",children:"Seleccionar Categor\xeda:"}),(0,r.jsxs)(eF,{onValueChange:m,value:n,children:[(0,r.jsx)(eV,{id:"category-select",className:"w-full mt-1",children:(0,r.jsx)(eP,{placeholder:"Seleccionar Categor\xeda",children:u})}),(0,r.jsx)(ez,{children:d.map(e=>(0,r.jsx)(eG,{value:e,children:"all"===e?"Todas las Categor\xedas":e},e))})]})]}),(0,r.jsx)(eE,{expenses:c,onDeleteExpense:a,groupName:"all"!==n?n:void 0,onDeleteGroup:"all"!==n?l:void 0,groupTypeLabel:"all"!==n?"Categor\xeda":void 0,groupDisplayName:u,title:x,caption:p,defaultCategoryKey:o})]})]})}var eY=a(45450),eB=a(3451),eU=a(3112),eW=a(24961),eJ=a(45218),eQ=a(11029),e$=a(11345),eq=a(45032),eX=a(53878);let e0={light:"",dark:".dark"},e2=s.createContext(null);function e1(){let e=s.useContext(e2);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let e4=s.forwardRef((e,t)=>{let{id:a,className:l,children:o,config:n,...i}=e,d=s.useId(),m="chart-".concat(a||d.replace(/:/g,""));return(0,r.jsx)(e2.Provider,{value:{config:n},children:(0,r.jsxs)("div",{"data-chart":m,ref:t,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...i,children:[(0,r.jsx)(e5,{id:m,config:n}),o]})})});e4.displayName="Chart";let e5=e=>{let{id:t,config:a}=e,s=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return s.length?(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(e0).map(e=>{let[a,r]=e;return"\n".concat(r," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[r,s]=e,l=(null===(t=s.theme)||void 0===t?void 0:t[a])||s.color;return l?"  --color-".concat(r,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null};function e3(e,t,a){if("object"!=typeof t||null===t)return;let r="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,s=a;return a in t&&"string"==typeof t[a]?s=t[a]:r&&a in r&&"string"==typeof r[a]&&(s=r[a]),s in e?e[s]:e[a]}eQ.u,s.forwardRef((e,t)=>{let{active:a,payload:l,className:o,indicator:n="dot",hideLabel:i=!1,hideIndicator:d=!1,label:m,labelFormatter:u,labelClassName:x,formatter:p,color:f,nameKey:h,labelKey:g}=e,{config:j}=e1(),v=s.useMemo(()=>{var e;if(i||!(null==l?void 0:l.length))return null;let[t]=l,a="".concat(g||t.dataKey||t.name||"value"),s=e3(j,t,a),o=g||"string"!=typeof m?null==s?void 0:s.label:(null===(e=j[m])||void 0===e?void 0:e.label)||m;return u?(0,r.jsx)("div",{className:(0,c.cn)("font-medium",x),children:u(o,l)}):o?(0,r.jsx)("div",{className:(0,c.cn)("font-medium",x),children:o}):null},[m,u,l,i,x,j,g]);if(!a||!(null==l?void 0:l.length))return null;let y=1===l.length&&"dot"!==n;return(0,r.jsxs)("div",{ref:t,className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",o),children:[y?null:v,(0,r.jsx)("div",{className:"grid gap-1.5",children:l.map((e,t)=>{let a="".concat(h||e.name||e.dataKey||"value"),s=e3(j,e,a),l=f||e.payload.fill||e.color;return(0,r.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:p&&(null==e?void 0:e.value)!==void 0&&e.name?p(e.value,e.name,e,t,e.payload):(0,r.jsxs)(r.Fragment,{children:[(null==s?void 0:s.icon)?(0,r.jsx)(s.icon,{}):!d&&(0,r.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":y&&"dashed"===n}),style:{"--color-bg":l,"--color-border":l}}),(0,r.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",y?"items-end":"items-center"),children:[(0,r.jsxs)("div",{className:"grid gap-1.5",children:[y?v:null,(0,r.jsx)("span",{className:"text-muted-foreground",children:(null==s?void 0:s.label)||e.name})]}),e.value&&(0,r.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}).displayName="ChartTooltip",eX.D,s.forwardRef((e,t)=>{let{className:a,hideIcon:s=!1,payload:l,verticalAlign:o="bottom",nameKey:n}=e,{config:i}=e1();return(null==l?void 0:l.length)?(0,r.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center justify-center gap-4","top"===o?"pb-3":"pt-3",a),children:l.map(e=>{let t="".concat(n||e.dataKey||"value"),a=e3(i,e,t);return(0,r.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==a?void 0:a.icon)&&!s?(0,r.jsx)(a.icon,{}):(0,r.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==a?void 0:a.label]},e.value)})}):null}).displayName="ChartLegend";let e6=(e,t)=>{let a=new Date,r=new Date(a);r.setDate(a.getDate()-t+1),r.setHours(0,0,0,0);let s={},l={},o=new Set,n=z.es,i=new Date(r);for(;i<=a;){let e=(0,I.WU)(i,"yyyy-MM-dd");s[e]={total:0,products:{}},o.add(e),i.setDate(i.getDate()+1)}return e.forEach(e=>{let t=new Date(e.timestamp);if(t.setHours(0,0,0,0),t>=r&&t<=a){let a=(0,I.WU)(t,"yyyy-MM-dd"),r=e.product.name;l[r]||(l[r]=e.product.name),s[a]||(s[a]={total:0,products:{}}),s[a].products[r]=(s[a].products[r]||0)+e.price,s[a].total+=e.price}}),{data:Array.from(o).map(e=>{let t=s[e],a=(0,I.WU)(new Date(e+"T00:00:00"),"dd MMM",{locale:n}),r=t?t.products:{};return{date:a,_rawDate:e,total:t?t.total:0,...r}}).sort((e,t)=>e._rawDate.localeCompare(t._rawDate)).map(e=>{let t={...e};return Object.keys(l).forEach(e=>{e in t||(t[e]=0)}),t}),productKeys:l}},e8=e=>{let t={total:{label:"Total",color:"hsl(var(--chart-1))"}},a=Object.keys(e);return a.forEach((r,s)=>{let l=360/(a.length+1)*s%360,o="hsl(".concat(l,", ").concat(Math.floor(21*Math.random())+70,"%, ").concat(Math.floor(21*Math.random())+55,"%)");t[r]={label:e[r],color:o}}),t};function e9(e){let{expenses:t}=e,[a,l]=(0,s.useState)(!1),[o,n]=(0,s.useState)([]),[i,d]=(0,s.useState)({}),[c,m]=(0,s.useState)([]),[u,x]=(0,s.useState)({}),[p,f]=(0,s.useState)([]),[h,g]=(0,s.useState)({});(0,s.useEffect)(()=>{l(!0);let e=e6(t,7);n(e.data),d(e.productKeys);let a=e6(t,30);m(a.data),x(a.productKeys);let r=e6(t,90);f(r.data),g(r.productKeys)},[t]);let j=e=>{let{active:t,payload:a,label:s,config:l,productKeysMap:o,expenses:n}=e;if(t&&a&&a.length){let e=a[0].payload,t=[];Object.keys(o).forEach(a=>{var r,s;let o=null===(r=n.find(e=>e.product.name===a))||void 0===r?void 0:r.product;if(o){let r=e[a]||0;t.push({...o,key:a,value:r,color:(null===(s=l[a])||void 0===s?void 0:s.color)||"#ccc"})}});let i=t.filter(e=>e.value>0).sort((e,t)=>t.value-e.value);return(0,r.jsxs)("div",{className:"rounded-lg border bg-background p-2.5 text-xs sm:text-sm shadow-lg max-w-[250px] sm:max-w-xs",children:[" ",(0,r.jsx)("div",{className:"mb-1.5 font-medium",children:s})," ",(0,r.jsxs)("div",{className:"mb-1 border-t pt-1 font-semibold",children:["Total D\xeda: ",A(e.total)]}),(0,r.jsxs)("div",{className:"grid gap-1",children:[i.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[" ",(0,r.jsx)("span",{className:"h-2.5 w-2.5 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),(0,r.jsxs)("span",{className:"text-muted-foreground truncate",children:[e.name,":"]})," "]}),(0,r.jsx)("span",{className:"font-semibold whitespace-nowrap",children:A(e.value)})," "]},e.key)),0===i.length&&(0,r.jsx)("div",{className:"text-muted-foreground text-xs",children:"Sin gastos registrados para este d\xeda."})]})]})}return null},v=(e,l,o)=>{let n=(0,s.useMemo)(()=>e8(l),[l]);if(!a)return(0,r.jsxs)("div",{className:"mt-4 p-4 rounded-md border bg-card space-y-2 min-h-[250px] sm:min-h-[350px]",children:[" ",(0,r.jsx)(er,{className:"h-5 sm:h-6 w-3/4 mb-4"}),(0,r.jsx)(er,{className:"h-[200px] sm:h-[300px] w-full"})]});if(0===e.length||e.every(e=>0===e.total)){let e=0===t.length?"Agrega gastos para ver el gr\xe1fico.":"No hay gastos en los \xfaltimos ".concat(o," d\xedas.");return(0,r.jsxs)("div",{className:"mt-4 p-4 rounded-md border bg-card text-center min-h-[250px] sm:min-h-[350px] flex items-center justify-center",children:[" ",(0,r.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:e})," "]})}return(0,r.jsxs)(e4,{config:n,className:"min-h-[250px] sm:min-h-[350px] w-full mt-4",children:[" ",(0,r.jsx)(eY.h,{width:"100%",height:a&&window.innerWidth<640?250:350,children:(0,r.jsxs)(eB.w,{data:e,margin:{top:5,right:5,left:-25,bottom:5},children:[(0,r.jsx)(eU.q,{vertical:!1,strokeDasharray:"3 3"}),(0,r.jsx)(eW.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,fontSize:10}),(0,r.jsx)(eJ.B,{tickFormatter:e=>A(e),tickLine:!1,axisLine:!1,tickMargin:8,width:60,fontSize:10}),(0,r.jsx)(eQ.u,{cursor:{fill:"hsl(var(--muted))",fillOpacity:.3},formatter:(e,t,a)=>[e,a.payload.name],content:e=>{let{active:a=!1,payload:s=[],label:o}=e;return(0,r.jsx)(j,{active:a,payload:s,label:o,config:n,productKeysMap:l,expenses:t})}}),(0,r.jsx)(e$.u,{type:"linear",dataKey:"total",stroke:"none",fill:"var(--color-total)",fillOpacity:.4}),(0,r.jsx)(eq.x,{type:"linear",dataKey:"total",stroke:"var(--color-total)",strokeWidth:2,dot:!1,activeDot:{r:4,fill:"var(--color-total)",stroke:"hsl(var(--background))",strokeWidth:2}})]})})]})};return(0,r.jsxs)(U,{children:[(0,r.jsxs)(W,{children:[(0,r.jsx)(J,{className:"text-lg sm:text-xl",children:"An\xe1lisis de Gastos Totales por D\xeda"})," "]}),(0,r.jsx)($,{children:(0,r.jsxs)(X,{defaultValue:"7days",className:"w-full",children:[(0,r.jsxs)(ee,{className:"grid w-full grid-cols-3",children:[(0,r.jsx)(et,{value:"7days",children:"7 D\xedas"})," ",(0,r.jsx)(et,{value:"30days",children:"30 D\xedas"})," ",(0,r.jsx)(et,{value:"90days",children:"90 D\xedas"})," "]}),(0,r.jsx)(ea,{value:"7days",children:v(o,i,"7")}),(0,r.jsx)(ea,{value:"30days",children:v(c,u,"30")}),(0,r.jsx)(ea,{value:"90days",children:v(p,h,"90")})]})})]})}let e7=(e,t)=>{try{let a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){if(a instanceof SyntaxError&&""===window.localStorage.getItem(e))return t;return console.error("Error reading localStorage key “".concat(e,"”:"),a),t}};var te=function(e,t){let[a,r]=(0,s.useState)(t),[l,o]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{o(!0)},[]),(0,s.useEffect)(()=>{l&&r(e7(e,t))},[e,l]),[l?a:t,(0,s.useCallback)(t=>{try{r(a=>{let r=t instanceof Function?t(a):t;return window.localStorage.setItem(e,JSON.stringify(r)),r})}catch(t){console.error("Error setting localStorage key “".concat(e,"”:"),t)}},[e])]},tt=a(57632),ta=a(9008),tr=a.n(ta),ts=a(52091),tl=a(45005),to=a(57460),tn=a.n(to),ti=a(93162);let td="no definido";function tc(){let{toast:e}=(0,S.pm)(),[t,a]=te("expenses",[]),[l,o]=te("categories",[td]),[n,i]=(0,s.useState)(!1),d=(0,s.useRef)(null);(0,s.useEffect)(()=>{i(!0)},[]),(0,s.useEffect)(()=>{l.includes(td)||o(e=>[...e,td].sort())},[l,o]);let c=e=>{a(t=>t.filter(t=>t.id!==e))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(tr(),{children:[(0,r.jsx)("title",{children:"Control de Gastos"}),(0,r.jsx)("meta",{name:"description",content:"Registra y analiza tus gastos f\xe1cilmente."})]}),(0,r.jsxs)("main",{className:"container mx-auto px-2 sm:px-4 py-4 min-h-screen",children:[(0,r.jsxs)("header",{className:"mb-6 md:mb-8 text-center relative",children:[(0,r.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-foreground",children:"Control de Gastos"}),(0,r.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:"Registra y analiza tus gastos f\xe1cilmente."})]}),(0,r.jsxs)(X,{defaultValue:"control",className:"w-full",children:[(0,r.jsxs)(ee,{className:"grid w-full grid-cols-3 mb-6",children:[(0,r.jsx)(et,{value:"control",children:"Control de gastos"}),(0,r.jsx)(et,{value:"reporting",children:"Reporter\xeda"}),(0,r.jsx)(et,{value:"data",children:"Exportar/Importar Data"})]}),(0,r.jsx)(ea,{value:"control",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[(0,r.jsx)("div",{className:"md:col-span-1",children:(0,r.jsx)(B,{onAddExpense:e=>{var t;let r=(null===(t=e.category)||void 0===t?void 0:t.trim())?e.category.trim():td,s={...e,category:r,id:(0,tt.Z)(),timestamp:new Date};r===td||l.includes(r)||o(e=>[...e,r].sort()),a(e=>[...e,s].sort((e,t)=>{var a,r,s,l;let o=null!==(s=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==s?s:0;return(null!==(l=null===(r=G(t.timestamp))||void 0===r?void 0:r.getTime())&&void 0!==l?l:0)-o}))},categories:l.filter(e=>e!==td),defaultCategoryKey:td})}),(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)(es,{expenses:t})})]})}),(0,r.jsx)(ea,{value:"reporting",children:(0,r.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,r.jsx)(e9,{expenses:t}),(0,r.jsx)(eL,{expenses:t,onDeleteExpense:c,onDeleteProduct:e=>{a(t=>t.filter(t=>t.product.name!==e))},defaultCategoryKey:td}),(0,r.jsx)(eZ,{expenses:t,onDeleteExpense:c,onDeleteCategory:e=>{a(t=>t.filter(t=>t.category!==e)),e!==td&&l.includes(e)&&o(t=>t.filter(t=>t!==e))},defaultCategoryKey:td})]})}),(0,r.jsx)(ea,{value:"data",children:(0,r.jsxs)(U,{children:[(0,r.jsxs)(W,{children:[(0,r.jsx)(J,{children:"Exportar/Importar Data (CSV)"}),(0,r.jsx)(Q,{children:"Exporta tus gastos a un archivo CSV o importa desde uno existente."})]}),(0,r.jsxs)($,{className:"flex flex-col sm:flex-row gap-2 sm:gap-4",children:[(0,r.jsx)("input",{type:"file",ref:d,onChange:t=>{if(!n||!t.target.files||0===t.target.files.length)return;let r=t.target.files[0],s=new FileReader;s.onload=t=>{var r;let s=null===(r=t.target)||void 0===r?void 0:r.result;if("string"==typeof s)try{let t=tn().parse(s,{header:!0,skipEmptyLines:!0}),r=[],n=new Set(l),i=0;t.errors.length>0&&(t.errors.forEach(e=>console.error("CSV Parsing Error:",e)),e({title:"Error de Formato CSV",description:"Se encontraron ".concat(t.errors.length," errores al leer el archivo. Verifica el formato."),variant:"destructive"})),t.data.forEach((e,t)=>{var a,s,l,o;let d=null===(a=e.Producto)||void 0===a?void 0:a.trim(),c=null===(s=e.Precio)||void 0===s?void 0:s.trim(),m=(null===(l=e.Categoria)||void 0===l?void 0:l.trim())||td,u=null===(o=e.Timestamp)||void 0===o?void 0:o.trim(),x=parseFloat(c),p=G(u);if(!d||isNaN(x)||x<=0||!p){console.warn("Fila ".concat(t+2," omitida: Datos inv\xe1lidos (Producto: ").concat(d,", Precio: ").concat(c,", Timestamp: ").concat(u,")")),i++;return}let f={id:(0,tt.Z)(),product:{name:d,value:0,color:""},price:x,category:m,timestamp:p};r.push(f),m!==td&&m&&n.add(m)}),r.length>0&&(a(e=>[...e,...r].sort((e,t)=>{var a,r,s,l;let o=null!==(s=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==s?s:0;return(null!==(l=null===(r=G(t.timestamp))||void 0===r?void 0:r.getTime())&&void 0!==l?l:0)-o})),o(Array.from(n).sort())),e({title:"Importaci\xf3n Completa",description:"".concat(r.length," gastos importados. ").concat(i>0?"".concat(i," filas omitidas por datos inv\xe1lidos."):"")})}catch(t){console.error("Error al importar CSV:",t),e({title:"Error de Importaci\xf3n",description:"No se pudo procesar el archivo CSV.",variant:"destructive"})}finally{d.current&&(d.current.value="")}},s.onerror=t=>{console.error("Error al leer archivo:",t),e({title:"Error de Lectura",description:"No se pudo leer el archivo seleccionado.",variant:"destructive"}),d.current&&(d.current.value="")},s.readAsText(r)},accept:".csv",style:{display:"none"},id:"import-csv-input"}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(u,{onClick:()=>{if(!n)return;let a=t.map(e=>({Producto:e.product.name,Precio:e.price,Categoria:e.category,Timestamp:e.timestamp instanceof Date?e.timestamp.toISOString():new Date(e.timestamp).toISOString()})),r=new Blob([tn().unparse(a,{header:!0})],{type:"text/csv;charset=utf-8;"});(0,ti.saveAs)(r,"gastos.csv"),e({title:"Exportaci\xf3n Completa",description:"Los datos de gastos se han exportado a gastos.csv."})},variant:"outline",className:"w-full sm:w-auto",children:[(0,r.jsx)(ts.Z,{className:"mr-2 h-4 w-4"})," Exportar a CSV"]}),(0,r.jsxs)(u,{onClick:()=>{n&&d.current&&d.current.click()},variant:"outline",className:"w-full sm:w-auto",children:[(0,r.jsx)(tl.Z,{className:"mr-2 h-4 w-4"})," Importar desde CSV"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(er,{className:"h-10 w-full sm:w-auto"}),(0,r.jsx)(er,{className:"h-10 w-full sm:w-auto"})]})]})]})})]})]})]})}}},function(e){e.O(0,[61,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);