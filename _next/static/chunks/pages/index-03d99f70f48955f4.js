(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(88135)}])},88135:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return tM}});var s=a(85893),r=a(67294),l=a(1604),n=a(56312),o=a(87536),i=a(88426),d=a(12003),c=a(53776);let m=(0,d.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=r.forwardRef((e,t)=>{let{className:a,variant:r,size:l,asChild:n=!1,...o}=e,d=n?i.g7:"button";return(0,s.jsx)(d,{className:(0,c.cn)(m({variant:r,size:l,className:a})),ref:t,...o})});u.displayName="Button";var x=a(49102);let p=(0,d.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(x.f,{ref:t,className:(0,c.cn)(p(),a),...r})});f.displayName=x.f.displayName;let h=o.RV,g=r.createContext({}),j=e=>{let{...t}=e;return(0,s.jsx)(g.Provider,{value:{name:t.name},children:(0,s.jsx)(o.Qr,{...t})})},y=()=>{let e=r.useContext(g),t=r.useContext(v),{getFieldState:a,formState:s}=(0,o.Gc)(),l=a(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...l}},v=r.createContext({}),N=r.forwardRef((e,t)=>{let{className:a,...l}=e,n=r.useId();return(0,s.jsx)(v.Provider,{value:{id:n},children:(0,s.jsx)("div",{ref:t,className:(0,c.cn)("space-y-2",a),...l})})});N.displayName="FormItem";let b=r.forwardRef((e,t)=>{let{className:a,...r}=e,{error:l,formItemId:n}=y();return(0,s.jsx)(f,{ref:t,className:(0,c.cn)(l&&"text-destructive",a),htmlFor:n,...r})});b.displayName="FormLabel";let w=r.forwardRef((e,t)=>{let{...a}=e,{error:r,formItemId:l,formDescriptionId:n,formMessageId:o}=y();return(0,s.jsx)(i.g7,{ref:t,id:l,"aria-describedby":r?"".concat(n," ").concat(o):"".concat(n),"aria-invalid":!!r,...a})});w.displayName="FormControl",r.forwardRef((e,t)=>{let{className:a,...r}=e,{formDescriptionId:l}=y();return(0,s.jsx)("p",{ref:t,id:l,className:(0,c.cn)("text-sm text-muted-foreground",a),...r})}).displayName="FormDescription";let k=r.forwardRef((e,t)=>{var a;let{className:r,children:l,...n}=e,{error:o,formMessageId:i}=y(),d=o?String(null!==(a=null==o?void 0:o.message)&&void 0!==a?a:""):l;return d?(0,s.jsx)("p",{ref:t,id:i,className:(0,c.cn)("text-sm font-medium text-destructive",r),...n,children:d}):null});k.displayName="FormMessage";let C=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});C.displayName="Input";var E=a(31987),S=a(64162),_=a(39784),R=a(37888),D=a(16045),T=a(42932),P=a(69508),F=a(10524),z=a(71371),V=a(61551),M=a(29302),O=a(52688);let G=e=>{if(e instanceof Date&&(0,S.J)(e))return e;if("string"==typeof e){let t=(0,_.D)(e);if((0,S.J)(t))return t}if("number"==typeof e){let t=new Date(e);if((0,S.J)(t))return t}return null},I=(e,t)=>{let a,s;let r=new Date;switch(t){case"week":a=(0,R.z)(r,{weekStartsOn:1}),s=(0,D.v)(r,{weekStartsOn:1});break;case"month":a=(0,T.N)(r),s=(0,P.V)(r);break;case"bi-weekly":let l=(0,T.N)(r),n=(0,P.V)(r),o=(0,F.i)(new Date(r.getFullYear(),r.getMonth(),15));r<=o?(a=(0,z.b)(l),s=o):(a=(0,z.b)(new Date(r.getFullYear(),r.getMonth(),16)),s=(0,F.i)(n));break;default:return[]}return a=(0,z.b)(a),s=(0,F.i)(s),e.filter(e=>{let t=G(e.timestamp);return t&&(0,V._)(t,{start:a,end:s})})},Z=e=>e.reduce((e,t)=>e+(t.price||0),0),A=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}),L=e=>((null==e||isNaN(e))&&(e=0),A.format(e)),K=e=>{if(null==e)return 0;let t=parseInt(String(e).replace(/[^\d]/g,""),10);return isNaN(t)?0:t},W=e=>{let t=G(e);if(!t)return"Fecha inv\xe1lida";let a=O.es;try{return(0,M.WU)(t,"PPpp",{locale:a})}catch(a){return console.error("Error formatting date:",a,"Input:",e,"Parsed:",t),t.toLocaleDateString("es-ES")+" "+t.toLocaleTimeString("es-ES")}},H=()=>l.Ry({product:l.Z_().min(1,{message:"El nombre del producto no puede estar vac\xedo."}),price:l.oQ.number().positive({message:"El precio debe ser un n\xfamero positivo."}),category:l.Z_().optional()});function U(e){let{onAddExpense:t,categories:a,defaultCategoryKey:l,productInputRef:i}=e,{toast:d}=(0,E.pm)(),[c,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)(""),f=(0,r.useMemo)(()=>H(),[]),g=(0,o.cI)({resolver:(0,n.F)(f),defaultValues:{product:"",price:0,category:""}}),y=g.watch("price");(0,r.useEffect)(()=>{"number"!=typeof y||isNaN(y)?p(L(0)):p(L(y))},[y]);let v=(e,t)=>{let a=K(e.target.value);p(L(isNaN(a)?0:a)),t(isNaN(a)?0:a)},S=(e,t)=>{p(L(isNaN(t)?0:t)),e()};async function _(e){m(!0);try{var a,s;let r=(null===(a=e.category)||void 0===a?void 0:a.trim())||l;await new Promise(e=>setTimeout(e,100)),t({product:{name:e.product,color:"",value:0},price:e.price,category:r}),d({title:"Gasto agregado",description:"Producto: ".concat(e.product,", Precio: ").concat(L(e.price),", Categor\xeda: ").concat(r)}),g.reset({product:"",price:0,category:""}),p(L(0)),null===(s=i.current)||void 0===s||s.focus()}catch(e){console.error("Error al agregar gasto:",e),d({title:"Error",description:"No se pudo agregar el gasto.",variant:"destructive"})}finally{m(!1)}}return(0,s.jsx)(h,{...g,children:(0,s.jsxs)("form",{onSubmit:g.handleSubmit(_),className:"space-y-3 sm:space-y-4 rounded-lg border bg-card p-4 sm:p-6 shadow-sm",children:[(0,s.jsx)(j,{control:g.control,name:"product",render:e=>{let{field:t}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{className:"text-xs sm:text-sm",children:"Producto"}),(0,s.jsx)(w,{children:(0,s.jsx)(C,{placeholder:"Ej: Caf\xe9",...t,ref:i})}),(0,s.jsx)(k,{})]})}}),(0,s.jsx)(j,{control:g.control,name:"price",render:e=>{let{field:t}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{className:"text-xs sm:text-sm",children:"Precio (COP)"}),(0,s.jsx)(w,{children:(0,s.jsx)(C,{type:"text",placeholder:L(0),...t,value:x,onChange:e=>v(e,t.onChange),onBlur:()=>S(t.onBlur,t.value),inputMode:"decimal"})}),(0,s.jsx)(k,{})]})}}),(0,s.jsx)(j,{control:g.control,name:"category",render:e=>{let{field:t}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{className:"text-xs sm:text-sm",children:"Categor\xeda (Opcional)"}),(0,s.jsx)(w,{children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C,{placeholder:"Ej: Comida",...t,list:"category-suggestions",autoComplete:"off"}),(0,s.jsx)("datalist",{id:"category-suggestions",children:a.map(e=>(0,s.jsx)("option",{value:e},e))})]})}),(0,s.jsx)(k,{})]})}}),(0,s.jsx)(u,{type:"submit",disabled:c,className:"w-full sm:w-auto",children:c?"Agregando...":"Agregar Gasto"})]})})}let B=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});B.displayName="Card";let Y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",a),...r})});Y.displayName="CardHeader";let J=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});J.displayName="CardTitle";let q=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...r})});q.displayName="CardDescription";let Q=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("p-6 pt-0",a),...r})});Q.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter";var $=a(31702);let X=$.fC,ee=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)($.aV,{ref:t,className:(0,c.cn)("inline-flex h-auto min-h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});ee.displayName=$.aV.displayName;let et=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)($.xz,{ref:t,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});et.displayName=$.xz.displayName;let ea=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)($.VY,{ref:t,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});function es(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-muted",t),...a})}function er(e){let{expenses:t}=e,[a,l]=(0,r.useState)(!1),[n,o]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[c,m]=(0,r.useState)(null),[u,x]=(0,r.useState)(0),[p,f]=(0,r.useState)(0),[h,g]=(0,r.useState)(0);(0,r.useEffect)(()=>{l(!0);let e=I(t,"week"),a=I(t,"bi-weekly"),s=I(t,"month");o(Z(e)),d(Z(a)),m(Z(s)),x(e.length),f(a.length),g(s.length)},[t]);let j=e=>{let t,r,l,o;switch(e){case"week":t=n,r=u,l="Total Gastado esta Semana",o="semana";break;case"bi-weekly":t=i,r=p,l="Total Gastado esta Quincena",o="quincena";break;case"month":t=c,r=h,l="Total Gastado este Mes",o="mes"}return a&&null!==t?(0,s.jsxs)("div",{className:"mt-4 p-3 sm:p-4 rounded-md border bg-card",children:[" ",(0,s.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:l})," ",(0,s.jsx)("p",{className:"text-xl sm:text-2xl font-bold text-primary",children:L(t)})," ",(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[r," gasto(s) esta ",o,"."]})," "]}):(0,s.jsxs)("div",{className:"mt-4 p-3 sm:p-4 rounded-md border bg-card space-y-2",children:[" ",(0,s.jsx)(es,{className:"h-5 sm:h-6 w-3/4"}),(0,s.jsx)(es,{className:"h-7 sm:h-8 w-1/2"}),(0,s.jsx)(es,{className:"h-4 w-1/4"})]})};return(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{className:"px-4 py-3 sm:px-6 sm:py-4",children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:a?"Resumen de Gastos":(0,s.jsx)(es,{className:"h-6 w-1/2"})})}),(0,s.jsx)(Q,{className:"px-4 pb-4 sm:px-6 sm:pb-6",children:(0,s.jsxs)(X,{defaultValue:"week",className:"w-full",children:[(0,s.jsxs)(ee,{className:"grid w-full grid-cols-3 h-auto text-xs sm:text-sm",children:[" ",a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et,{value:"week",className:"py-1.5 sm:py-2",children:"Semana"})," ",(0,s.jsx)(et,{value:"bi-weekly",className:"py-1.5 sm:py-2",children:"Quincena"})," ",(0,s.jsx)(et,{value:"month",className:"py-1.5 sm:py-2",children:"Mes"})," "]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es,{className:"h-9 w-full"}),(0,s.jsx)(es,{className:"h-9 w-full"}),(0,s.jsx)(es,{className:"h-9 w-full"})]})]}),(0,s.jsx)(ea,{value:"week",children:j("week")}),(0,s.jsx)(ea,{value:"bi-weekly",children:j("bi-weekly")}),(0,s.jsx)(ea,{value:"month",children:j("month")})]})})]})}ea.displayName=$.VY.displayName;let el=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{ref:t,className:(0,c.cn)("w-full caption-bottom text-sm",a),...r})})});el.displayName="Table";let en=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,c.cn)("[&_tr]:border-b",a),...r})});en.displayName="TableHeader";let eo=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,c.cn)("[&_tr:last-child]:border-0",a),...r})});eo.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let ei=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});ei.displayName="TableRow";let ed=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,c.cn)("h-10 sm:h-12 px-2 sm:px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 whitespace-nowrap",a),...r})});ed.displayName="TableHead";let ec=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,c.cn)("p-2 sm:p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});ec.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,c.cn)("mt-4 text-xs sm:text-sm text-muted-foreground px-2 sm:px-4",a),...r})}).displayName="TableCaption";var em=a(73260),eu=a(50186),ex=a(89532);let ep=ex.fC,ef=ex.xz,eh=ex.h_,eg=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ex.aV,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});eg.displayName=ex.aV.displayName;let ej=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(eh,{children:[(0,s.jsx)(eg,{}),(0,s.jsx)(ex.VY,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});ej.displayName=ex.VY.displayName;let ey=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};ey.displayName="AlertDialogHeader";let ev=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};ev.displayName="AlertDialogFooter";let eN=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ex.Dx,{ref:t,className:(0,c.cn)("text-lg font-semibold",a),...r})});eN.displayName=ex.Dx.displayName;let eb=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ex.dk,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...r})});eb.displayName=ex.dk.displayName;let ew=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ex.aU,{ref:t,className:(0,c.cn)(m(),a),...r})});ew.displayName=ex.aU.displayName;let ek=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ex.$j,{ref:t,className:(0,c.cn)(m({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});ek.displayName=ex.$j.displayName;let eC=(0,d.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eE(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,c.cn)(eC({variant:a}),t),...r})}function eS(e){let{expenses:t,onDeleteExpense:a,onEditExpense:r,groupName:l,groupDisplayName:n,onDeleteGroup:o,groupTypeLabel:i,defaultCategoryKey:d}=e,{toast:c}=(0,E.pm)(),m="product"===i?"Producto":"category"===i?"Categor\xeda":"Grupo",x=e=>{a(e),c({title:"Gasto eliminado",description:"El gasto ha sido eliminado exitosamente."})},p=e=>{o&&e&&o(e)};if(!t||0===t.length)return(0,s.jsx)("div",{className:"text-muted-foreground text-center p-4",children:"No hay gastos para mostrar con los filtros seleccionados."});let f=!!o&&!!l&&!!i;return(0,s.jsxs)(s.Fragment,{children:[f&&l&&(0,s.jsx)("div",{className:"mb-4 text-right",children:(0,s.jsxs)(ep,{children:[(0,s.jsx)(ef,{asChild:!0,children:(0,s.jsxs)(u,{variant:"destructive",size:"sm",className:"w-full sm:w-auto",disabled:"category"===i&&l===d,children:[(0,s.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," Eliminar ",m," (",n||l,")"]})}),(0,s.jsxs)(ej,{children:[(0,s.jsxs)(ey,{children:[(0,s.jsx)(eN,{children:"\xbfEst\xe1s seguro?"}),(0,s.jsxs)(eb,{children:["Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente todas las entradas para ",m.toLowerCase(),' "',n||l,'".',"category"===i&&l!==d&&" La categor\xeda tambi\xe9n ser\xe1 eliminada de la lista de sugerencias."]})]}),(0,s.jsxs)(ev,{children:[(0,s.jsx)(ek,{children:"Cancelar"}),(0,s.jsxs)(ew,{onClick:()=>p(l),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:["Eliminar ",m]})]})]})]})}),(0,s.jsxs)(el,{children:[(0,s.jsx)(en,{children:(0,s.jsxs)(ei,{children:[(0,s.jsx)(ed,{className:"px-2 py-2 sm:px-4",children:"Producto"}),(0,s.jsx)(ed,{className:"px-2 py-2 sm:px-4",children:"Precio"}),(0,s.jsx)(ed,{className:"hidden md:table-cell px-2 py-2 sm:px-4",children:"Categor\xeda"}),(0,s.jsx)(ed,{className:"hidden lg:table-cell px-2 py-2 sm:px-4",children:"Fecha y Hora"}),(0,s.jsx)(ed,{className:"text-right px-2 py-2 sm:px-4",children:"Acciones"})]})}),(0,s.jsx)(eo,{children:t.sort((e,t)=>{var a,s,r,l;let n=null!==(r=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==r?r:0;return(null!==(l=null===(s=G(t.timestamp))||void 0===s?void 0:s.getTime())&&void 0!==l?l:0)-n}).map(e=>(0,s.jsxs)(ei,{children:[(0,s.jsx)(ec,{className:"font-medium px-2 py-2 sm:px-4 truncate max-w-[100px] sm:max-w-xs",children:e.product.name}),(0,s.jsx)(ec,{className:"px-2 py-2 sm:px-4 whitespace-nowrap",children:L(e.price)}),(0,s.jsx)(ec,{className:"hidden md:table-cell px-2 py-2 sm:px-4",children:(0,s.jsx)(eE,{variant:e.category===d?"secondary":"outline",className:"text-xs",children:e.category||d})}),(0,s.jsx)(ec,{className:"hidden lg:table-cell px-2 py-2 sm:px-4 whitespace-nowrap",children:W(e.timestamp)}),(0,s.jsxs)(ec,{className:"text-right px-2 py-2 sm:px-4",children:[(0,s.jsxs)(u,{variant:"ghost",size:"icon",onClick:()=>r(e),className:"mr-1",children:[(0,s.jsx)(eu.Z,{className:"h-4 w-4 text-blue-500"}),(0,s.jsx)("span",{className:"sr-only",children:"Editar"})]}),(0,s.jsxs)(ep,{children:[(0,s.jsx)(ef,{asChild:!0,children:(0,s.jsxs)(u,{variant:"ghost",size:"icon",children:[(0,s.jsx)(em.Z,{className:"h-4 w-4 text-destructive"}),(0,s.jsx)("span",{className:"sr-only",children:"Eliminar"})]})}),(0,s.jsxs)(ej,{children:[(0,s.jsxs)(ey,{children:[(0,s.jsx)(eN,{children:"\xbfEst\xe1s seguro?"}),(0,s.jsxs)(eb,{children:['Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente el gasto "',e.product.name,'" con precio ',L(e.price),"."]})]}),(0,s.jsxs)(ev,{children:[(0,s.jsx)(ek,{children:"Cancelar"}),(0,s.jsx)(ew,{onClick:()=>x(e.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar Gasto"})]})]})]})]})]},e.id))})]})]})}var e_=a(45450),eR=a(23435),eD=a(3112),eT=a(24961),eP=a(45218),eF=a(11029),ez=a(11345),eV=a(45032),eM=a(55623),eO=a(53878);let eG={light:"",dark:".dark"},eI=r.createContext(null);function eZ(){let e=r.useContext(eI);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let eA=r.forwardRef((e,t)=>{let{id:a,className:l,children:n,config:o,...i}=e,d=r.useId(),m="chart-".concat(a||d.replace(/:/g,""));return(0,s.jsx)(eI.Provider,{value:{config:o},children:(0,s.jsxs)("div",{"data-chart":m,ref:t,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...i,children:[(0,s.jsx)(eL,{id:m,config:o}),n]})})});eA.displayName="Chart";let eL=e=>{let{id:t,config:a}=e,r=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eG).map(e=>{let[a,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[s,r]=e,l=(null===(t=r.theme)||void 0===t?void 0:t[a])||r.color;return l?"  --color-".concat(s,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null};function eK(e,t,a){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=a;return a in t&&"string"==typeof t[a]?r=t[a]:s&&a in s&&"string"==typeof s[a]&&(r=s[a]),r in e?e[r]:e[a]}eF.u,r.forwardRef((e,t)=>{let{active:a,payload:l,className:n,indicator:o="dot",hideLabel:i=!1,hideIndicator:d=!1,label:m,labelFormatter:u,labelClassName:x,formatter:p,color:f,nameKey:h,labelKey:g}=e,{config:j}=eZ(),y=r.useMemo(()=>{var e;if(i||!(null==l?void 0:l.length))return null;let[t]=l,a="".concat(g||t.dataKey||t.name||"value"),r=eK(j,t,a),n=g||"string"!=typeof m?null==r?void 0:r.label:(null===(e=j[m])||void 0===e?void 0:e.label)||m;return u?(0,s.jsx)("div",{className:(0,c.cn)("font-medium",x),children:u(n,l)}):n?(0,s.jsx)("div",{className:(0,c.cn)("font-medium",x),children:n}):null},[m,u,l,i,x,j,g]);if(!a||!(null==l?void 0:l.length))return null;let v=1===l.length&&"dot"!==o;return(0,s.jsxs)("div",{ref:t,className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[v?null:y,(0,s.jsx)("div",{className:"grid gap-1.5",children:l.map((e,t)=>{let a="".concat(h||e.name||e.dataKey||"value"),r=eK(j,e,a),l=f||e.payload.fill||e.color;return(0,s.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===o&&"items-center"),children:p&&(null==e?void 0:e.value)!==void 0&&e.name?p(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==r?void 0:r.icon)?(0,s.jsx)(r.icon,{}):!d&&(0,s.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===o,"w-1":"line"===o,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===o,"my-0.5":v&&"dashed"===o}),style:{"--color-bg":l,"--color-border":l}}),(0,s.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[v?y:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,s.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}).displayName="ChartTooltip",eO.D,r.forwardRef((e,t)=>{let{className:a,hideIcon:r=!1,payload:l,verticalAlign:n="bottom",nameKey:o}=e,{config:i}=eZ();return(null==l?void 0:l.length)?(0,s.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center justify-center gap-4","top"===n?"pb-3":"pt-3",a),children:l.map(e=>{let t="".concat(o||e.dataKey||"value"),a=eK(i,e,t);return(0,s.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==a?void 0:a.icon)&&!r?(0,s.jsx)(a.icon,{}):(0,s.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==a?void 0:a.label]},e.value)})}):null}).displayName="ChartLegend";let eW=(e,t,a)=>{let s={},r=new Map,l=(0,z.b)(t),n=(0,z.b)(a);if(l>n)return{data:[],productKeysMap:{},chartConfig:{}};(0,eM.D)({start:l,end:n}).forEach(e=>{let t=(0,M.WU)(e,"dd MMM",{locale:O.es});r.set((0,M.WU)(e,"yyyy-MM-dd"),{date:t,_rawDate:e,total:0})}),e.forEach(e=>{let t=G(e.timestamp);if(!t)return;let a=(0,z.b)(t),l=(0,M.WU)(a,"yyyy-MM-dd"),n=r.get(l);if(n){let t=e.product.name;s[t]||(s[t]=e.product.name),n.total+=e.price,n[t]=(n[t]||0)+e.price}});let o=Array.from(r.values()).sort((e,t)=>e._rawDate.getTime()-t._rawDate.getTime()).map(e=>{let t={...e};return Object.keys(s).forEach(e=>{e in t||(t[e]=0)}),t}),i={total:{label:"Total",color:"hsl(var(--chart-1))"}};return Object.keys(s).forEach((e,t)=>{let a=360/(Object.keys(s).length+2)*t%360;i[e]={label:s[e],color:"hsl(".concat(a,", ").concat(Math.floor(21*Math.random())+70,"%, ").concat(Math.floor(21*Math.random())+55,"%)")}}),{data:o,productKeysMap:s,chartConfig:i}};function eH(e){let{expenses:t,startDate:a,endDate:l}=e,[n,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{o(!0)},[]);let{data:i,productKeysMap:d,chartConfig:c}=(0,r.useMemo)(()=>n?eW(t,a,l):{data:[],productKeysMap:{},chartConfig:{}},[t,a,l,n]),m=e=>{let{active:t,payload:a,label:r}=e;if(t&&a&&a.length&&r){let e=a[0].payload,t=[];return Object.keys(d).forEach(a=>{let s=c[a],r=e[a]||0;s&&r>0&&t.push({name:d[a],value:r,color:s.color||"#ccc",key:a})}),t.sort((e,t)=>t.value-e.value),(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-2.5 text-xs sm:text-sm shadow-lg max-w-[250px] sm:max-w-xs",children:[(0,s.jsx)("div",{className:"mb-1.5 font-medium",children:r})," ",(0,s.jsxs)("div",{className:"mb-1 border-t pt-1 font-semibold",children:["Total D\xeda: ",L(e.total)]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[t.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[(0,s.jsx)("span",{className:"h-2.5 w-2.5 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),(0,s.jsxs)("span",{className:"text-muted-foreground truncate",children:[e.name,":"]})]}),(0,s.jsx)("span",{className:"font-semibold whitespace-nowrap",children:L(e.value)})]},e.key)),0===t.length&&e.total>0&&(0,s.jsx)("div",{className:"text-muted-foreground text-xs",children:"Detalle de productos no disponible para este total."}),0===e.total&&(0,s.jsx)("div",{className:"text-muted-foreground text-xs",children:"Sin gastos registrados para este d\xeda."})]})]})}return null};return n?0===t.length||0===i.length||i.every(e=>0===e.total)?(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"An\xe1lisis de Gastos Totales por D\xeda"})}),(0,s.jsx)(Q,{className:"min-h-[250px] sm:min-h-[350px] flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:"No hay gastos para el per\xedodo o filtros seleccionados."})})]}):(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"An\xe1lisis de Gastos Totales por D\xeda"})}),(0,s.jsx)(Q,{children:(0,s.jsx)(eA,{config:c,className:"min-h-[250px] sm:min-h-[350px] w-full",children:(0,s.jsx)(e_.h,{width:"100%",height:n&&window.innerWidth<640?250:350,children:(0,s.jsxs)(eR.w,{data:i,margin:{top:5,right:5,left:-25,bottom:5},children:[(0,s.jsx)(eD.q,{vertical:!1,strokeDasharray:"3 3"}),(0,s.jsx)(eT.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,fontSize:10,interval:"preserveStartEnd"}),(0,s.jsx)(eP.B,{tickFormatter:e=>L(e),tickLine:!1,axisLine:!1,tickMargin:8,width:60,fontSize:10}),(0,s.jsx)(eF.u,{cursor:{fill:"hsl(var(--muted))",fillOpacity:.3},content:e=>{let{active:t,payload:a,label:r}=e;return(0,s.jsx)(m,{active:t,payload:a,label:r})}}),(0,s.jsx)(ez.u,{type:"linear",dataKey:"total",stroke:"none",fill:"var(--color-total)",fillOpacity:.4,name:"Total"}),(0,s.jsx)(eV.x,{type:"linear",dataKey:"total",stroke:"var(--color-total)",strokeWidth:2,dot:!1,activeDot:{r:4,fill:"var(--color-total)",stroke:"hsl(var(--background))",strokeWidth:2},name:"Total"})]})})})})]}):(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{children:(0,s.jsx)(es,{className:"h-6 w-3/4"})})}),(0,s.jsx)(Q,{className:"min-h-[250px] sm:min-h-[350px] flex items-center justify-center",children:(0,s.jsx)(es,{className:"h-full w-full"})})]})}var eU=a(31549),eB=a(53607),eY=a(64011),eJ=a(55164),eq=a(40243);let eQ=e=>{let t=[];for(let a=0;a<e;a++){let s=360/e*a%360;t.push("hsl(".concat(s,", 70%, 60%)"))}return t},e$=(e,t)=>{let a=new Map;return e.forEach(e=>{let s=e.category||t;a.set(s,(a.get(s)||0)+e.price)}),a};function eX(e){let{expenses:t,defaultCategoryKey:a}=e,[l,n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{n(!0)},[]);let{pieData:o,barData:i,chartConfig:d}=(0,r.useMemo)(()=>{if(!l)return{pieData:[],barData:[],chartConfig:{}};let e=e$(t,a);if(0===e.size)return{pieData:[],barData:[],chartConfig:{}};let s=Array.from(e.values()).reduce((e,t)=>e+t,0),r=eQ(e.size),n={},o=0,i=[],d=[];return e.forEach((e,t)=>{let a=r[o%r.length];n[t]={label:t,color:a},i.push({name:t,value:e,percentage:s>0?e/s*100:0,fill:a}),d.push({name:t,total:e,fill:a}),o++}),i.sort((e,t)=>t.value-e.value),d.sort((e,t)=>t.total-e.total),{pieData:i,barData:d,chartConfig:n}},[t,a,l]);return l?0===t.length||0===o.length?(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 md:gap-6",children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"Gastos por Categor\xeda (Pastel)"})}),(0,s.jsx)(Q,{className:"flex items-center justify-center min-h-[250px] sm:min-h-[350px]",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No hay datos de categor\xedas para mostrar."})})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"Gastos por Categor\xeda (Barras)"})}),(0,s.jsx)(Q,{className:"flex items-center justify-center min-h-[250px] sm:min-h-[350px]",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No hay datos de categor\xedas para mostrar."})})]})]}):(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 md:gap-6",children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"Gastos por Categor\xeda (Pastel)"})}),(0,s.jsx)(Q,{className:"min-h-[250px] sm:min-h-[350px] flex items-center justify-center",children:(0,s.jsx)(eA,{config:d,className:"w-full h-full max-h-[300px] sm:max-h-[350px]",children:(0,s.jsx)(e_.h,{width:"100%",height:"100%",children:(0,s.jsxs)(eU.u,{children:[(0,s.jsx)(eF.u,{content:(0,s.jsx)(e=>{let{active:t,payload:a}=e;if(t&&a&&a.length){var r;let e=a[0].payload;return(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-2.5 text-xs shadow-lg",children:[(0,s.jsx)("p",{className:"font-medium",children:"".concat(e.name)}),(0,s.jsx)("p",{children:"Total: ".concat(L(e.value))}),(0,s.jsx)("p",{children:"Porcentaje: ".concat(null===(r=e.percentage)||void 0===r?void 0:r.toFixed(1),"%")})]})}return null},{})}),(0,s.jsx)(eO.D,{layout:"horizontal",verticalAlign:"bottom",align:"center",wrapperStyle:{paddingTop:"10px"},iconSize:10}),(0,s.jsx)(eB.b,{data:o,cx:"50%",cy:"50%",labelLine:!1,outerRadius:"80%",dataKey:"value",nameKey:"name",children:o.map((e,t)=>(0,s.jsx)(eY.b,{fill:e.fill},"cell-".concat(t)))})]})})})})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"Gastos por Categor\xeda (Barras)"})}),(0,s.jsx)(Q,{className:"min-h-[250px] sm:min-h-[350px]",children:(0,s.jsx)(eA,{config:d,className:"w-full h-full",children:(0,s.jsx)(e_.h,{width:"100%",height:l&&window.innerWidth<640?250:350,children:(0,s.jsxs)(eJ.v,{data:i,layout:"vertical",margin:{top:5,right:20,left:50,bottom:5},children:[(0,s.jsx)(eD.q,{strokeDasharray:"3 3",horizontal:!1}),(0,s.jsx)(eT.K,{type:"number",tickFormatter:e=>L(e),fontSize:10}),(0,s.jsx)(eP.B,{dataKey:"name",type:"category",width:80,tick:{fontSize:10,width:75,textAnchor:"end"},interval:0}),(0,s.jsx)(eF.u,{content:(0,s.jsx)(e=>{let{active:t,payload:a,label:r}=e;return t&&a&&a.length?(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-2.5 text-xs shadow-lg",children:[(0,s.jsx)("p",{className:"font-medium",children:r}),(0,s.jsx)("p",{children:"Total: ".concat(L(a[0].value))})]}):null},{}),cursor:{fill:"hsl(var(--muted))",fillOpacity:.3}}),(0,s.jsx)(eq.$,{dataKey:"total",radius:[0,4,4,0],children:i.map((e,t)=>(0,s.jsx)(eY.b,{fill:e.fill},"cell-".concat(t)))})]})})})})]})]}):(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 md:gap-6",children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{children:(0,s.jsx)(es,{className:"h-6 w-3/4"})})}),(0,s.jsx)(Q,{className:"flex items-center justify-center min-h-[250px] sm:min-h-[350px]",children:(0,s.jsx)(es,{className:"h-full w-full"})})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{children:(0,s.jsx)(es,{className:"h-6 w-3/4"})})}),(0,s.jsx)(Q,{className:"min-h-[250px] sm:min-h-[350px]",children:(0,s.jsx)(es,{className:"h-full w-full"})})]})]})}var e0=a(12854),e2=a(98455);let e1=e0.fC;e0.xz;let e5=e0.h_,e4=e0.x8,e3=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(e0.aV,{ref:t,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});e3.displayName=e0.aV.displayName;let e6=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(e5,{children:[(0,s.jsx)(e3,{}),(0,s.jsxs)(e0.VY,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,s.jsxs)(e0.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(e2.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});e6.displayName=e0.VY.displayName;let e8=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};e8.displayName="DialogHeader";let e9=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};e9.displayName="DialogFooter";let e7=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(e0.Dx,{ref:t,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});e7.displayName=e0.Dx.displayName;let te=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(e0.dk,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",a),...r})});te.displayName=e0.dk.displayName;let tt=l.Ry({product:l.Z_().min(1,{message:"El nombre del producto no puede estar vac\xedo."}),price:l.oQ.number().positive({message:"El precio debe ser un n\xfamero positivo."}),category:l.Z_().optional()});function ta(e){let{expense:t,onSave:a,onCancel:l,categories:i,defaultCategoryKey:d}=e,[c,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)(""),f=(0,o.cI)({resolver:(0,n.F)(tt),defaultValues:{product:t.product.name,price:t.price,category:t.category===d?"":t.category}}),g=f.watch("price");(0,r.useEffect)(()=>{f.reset({product:t.product.name,price:t.price,category:t.category===d?"":t.category}),p(L(t.price))},[t,f,d]),(0,r.useEffect)(()=>{"number"!=typeof g||isNaN(g)?x!==L(0)&&p(L(0)):p(L(g))},[g,x]);let y=(e,t)=>{let a=K(e.target.value),s=L(isNaN(a)?0:a);x!==s&&p(s),t(isNaN(a)?0:a)},v=(e,t)=>{let a=L(isNaN(t)?0:t);x!==a&&p(a),e()};async function E(e){m(!0);try{var s;let r=(null===(s=e.category)||void 0===s?void 0:s.trim())||d,l={...t,product:{...t.product,name:e.product},price:e.price,category:r};await new Promise(e=>setTimeout(e,100)),a(l)}catch(e){console.error("Error al actualizar gasto:",e)}finally{m(!1)}}return(0,s.jsx)(e1,{open:!0,onOpenChange:e=>!e&&l(),children:(0,s.jsxs)(e6,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(e8,{children:[(0,s.jsx)(e7,{children:"Editar Gasto"}),(0,s.jsx)(te,{children:'Modifica los detalles de tu gasto. Haz clic en "Guardar Cambios" cuando termines.'})]}),(0,s.jsx)(h,{...f,children:(0,s.jsxs)("form",{onSubmit:f.handleSubmit(E),className:"space-y-4 py-4",children:[(0,s.jsx)(j,{control:f.control,name:"product",render:e=>{let{field:t}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{children:"Producto"}),(0,s.jsx)(w,{children:(0,s.jsx)(C,{placeholder:"Ej: Caf\xe9",...t})}),(0,s.jsx)(k,{})]})}}),(0,s.jsx)(j,{control:f.control,name:"price",render:e=>{let{field:t}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{children:"Precio (COP)"}),(0,s.jsx)(w,{children:(0,s.jsx)(C,{type:"text",placeholder:L(0),...t,value:x,onChange:e=>y(e,t.onChange),onBlur:()=>v(t.onBlur,t.value),inputMode:"decimal"})}),(0,s.jsx)(k,{})]})}}),(0,s.jsx)(j,{control:f.control,name:"category",render:e=>{let{field:t}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(b,{children:"Categor\xeda (Opcional)"}),(0,s.jsx)(w,{children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C,{placeholder:"Ej: Comida",...t,list:"edit-category-suggestions",autoComplete:"off"}),(0,s.jsx)("datalist",{id:"edit-category-suggestions",children:i.map(e=>(0,s.jsx)("option",{value:e},e))})]})}),(0,s.jsx)(k,{})]})}}),(0,s.jsxs)(e9,{children:[(0,s.jsx)(e4,{asChild:!0,children:(0,s.jsx)(u,{type:"button",variant:"outline",onClick:l,children:"Cancelar"})}),(0,s.jsx)(u,{type:"submit",disabled:c,children:c?"Guardando...":"Guardar Cambios"})]})]})})]})})}let ts=(e,t)=>{try{let a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){if(a instanceof SyntaxError&&""===window.localStorage.getItem(e))return t;return console.error("Error reading localStorage key “".concat(e,"”:"),a),t}};var tr=function(e,t){let[a,s]=(0,r.useState)(t),[l,n]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{n(!0)},[]),(0,r.useEffect)(()=>{l&&s(ts(e,t))},[e,l]),[l?a:t,(0,r.useCallback)(t=>{try{s(a=>{let s=t instanceof Function?t(a):t;return window.localStorage.setItem(e,JSON.stringify(s)),s})}catch(t){console.error("Error setting localStorage key “".concat(e,"”:"),t)}},[e])]},tl=a(57632),tn=a(9008),to=a.n(tn),ti=a(97870),td=a(48095),tc=a(52091),tm=a(45005),tu=a(57460),tx=a.n(tu),tp=a(93162),tf=a(76405),th=a(54046),tg=a(56169),tj=a(81670);let ty=tf.fC;tf.ZA;let tv=tf.B4,tN=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(tf.xz,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,s.jsx)(tf.JO,{asChild:!0,children:(0,s.jsx)(th.Z,{className:"h-4 w-4 opacity-50"})})]})});tN.displayName=tf.xz.displayName;let tb=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tf.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(tg.Z,{className:"h-4 w-4"})})});tb.displayName=tf.u_.displayName;let tw=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tf.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(th.Z,{className:"h-4 w-4"})})});tw.displayName=tf.$G.displayName;let tk=r.forwardRef((e,t)=>{let{className:a,children:r,position:l="popper",...n}=e;return(0,s.jsx)(tf.h_,{children:(0,s.jsxs)(tf.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,s.jsx)(tb,{}),(0,s.jsx)(tf.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(tw,{})]})})});tk.displayName=tf.VY.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tf.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=tf.__.displayName;let tC=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(tf.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(tf.wU,{children:(0,s.jsx)(tj.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(tf.eT,{children:r})]})});tC.displayName=tf.ck.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tf.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=tf.Z0.displayName;var tE=a(37402),tS=a(8659),t_=a(52217);function tR(e){let{className:t,classNames:a,showOutsideDays:r=!0,...l}=e;return(0,s.jsx)(t_._W,{showOutsideDays:r,className:(0,c.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,c.cn)(m({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,c.cn)(m({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,s.jsx)(tE.Z,{className:(0,c.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,s.jsx)(tS.Z,{className:(0,c.cn)("h-4 w-4",t),...a})}},...l})}tR.displayName="Calendar";var tD=a(86419);let tT=tD.fC,tP=tD.xz,tF=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:l=4,...n}=e;return(0,s.jsx)(tD.h_,{children:(0,s.jsx)(tD.VY,{ref:t,align:r,sideOffset:l,className:(0,c.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});tF.displayName=tD.VY.displayName;var tz=a(75507);let tV="no definido";function tM(){let e,t,a,l,n,o;let{toast:i}=(0,E.pm)(),[d,m]=tr("expenses",[]),[x,p]=tr("categories",[tV]),[h,g]=(0,r.useState)(!1),j=(0,r.useRef)(null),y=(0,r.useRef)(null),[v,N]=(0,r.useState)(null),[b,w]=(0,r.useState)("all"),[k,C]=(0,r.useState)("all"),[S,_]=(0,r.useState)(null),[R,D]=(0,r.useState)(null),[T,P]=(0,r.useState)("allTime");(0,r.useEffect)(()=>{g(!0)},[]),(0,r.useEffect)(()=>{h&&!x.includes(tV)&&p(e=>[...e,tV].sort())},[x,p,h]),(0,r.useEffect)(()=>{if(!h)return;let e=new Date,t=null,a=null;if("allTime"===T)t=null,a=null;else if("7days"===T)t=(0,z.b)((0,tz.k)(e,6)),a=(0,F.i)(e);else if("30days"===T)t=(0,z.b)((0,tz.k)(e,29)),a=(0,F.i)(e);else if("90days"===T)t=(0,z.b)((0,tz.k)(e,89)),a=(0,F.i)(e);else if("custom"===T)return;_(t),D(a)},[T,h]);let I=(0,r.useMemo)(()=>h?["all",...Array.from(new Set(d.map(e=>e.product.name))).sort()]:["all"],[d,h]),Z=(0,r.useMemo)(()=>h?["all",...Array.from(new Set(d.map(e=>e.category||tV))).sort()]:["all"],[d,h]),A=(0,r.useMemo)(()=>h?d.filter(e=>{let t="all"===b||e.product.name===b,a="all"===k||(e.category||tV)===k,s=G(e.timestamp);if(!s)return!1;let r=!0,l=S?(0,z.b)(S):null,n=R?(0,F.i)(R):null;return l&&n?r=(0,V._)(s,{start:l,end:n}):l?r=s>=l:n&&(r=s<=n),t&&a&&r}):[],[d,b,k,S,R,h]),K=(0,r.useMemo)(()=>h?A.reduce((e,t)=>e+t.price,0):0,[A,h]),W=(e,t)=>{e(t),P("custom")};if(h){let s="all"!==b,r="all"!==k,n=!S&&!R;s&&!r&&n?(e="product",t=b,a=b,l=e=>{m(t=>t.filter(t=>t.product.name!==e)),i({title:"Producto Eliminado",description:'Todas las entradas para el producto "'.concat(e,'" han sido eliminadas.')})}):r&&!s&&n&&(e="category",t=k,a=k,l=e=>{if(e===tV){i({title:"Acci\xf3n no permitida",description:'La categor\xeda "'.concat(tV,'" no puede ser eliminada, pero sus gastos s\xed.'),variant:"destructive"});return}m(t=>t.filter(t=>t.category!==e)),x.includes(e)&&p(t=>t.filter(t=>t!==e)),i({title:"Categor\xeda Eliminada",description:'Todas las entradas para la categor\xeda "'.concat(e,'" han sido eliminadas, y la categor\xeda ha sido removida de la lista.')})})}let{minExpenseDateOverall:H,maxExpenseDateOverall:$}=(0,r.useMemo)(()=>{if(!h||0===d.length){let e=new Date;return{minExpenseDateOverall:(0,z.b)((0,tz.k)(e,6)),maxExpenseDateOverall:(0,F.i)(e)}}let e=null,t=null;d.forEach(a=>{let s=G(a.timestamp);s&&((null===e||s<e)&&(e=s),(null===t||s>t)&&(t=s))});let a=(0,z.b)((0,tz.k)(new Date,6)),s=(0,F.i)(new Date);return{minExpenseDateOverall:e?(0,z.b)(e):a,maxExpenseDateOverall:t?(0,F.i)(t):s}},[d,h]),el=null!=S?S:H,en=null!=R?R:$;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(to(),{children:[(0,s.jsx)("title",{children:"Control de Gastos"}),(0,s.jsx)("meta",{name:"description",content:"Registra y analiza tus gastos f\xe1cilmente."})]}),(0,s.jsxs)("main",{className:"container mx-auto px-2 sm:px-4 py-4 min-h-screen",children:[(0,s.jsxs)("header",{className:"mb-6 md:mb-8 text-center relative",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-foreground",children:"Control de Gastos"}),(0,s.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:"Registra y analiza tus gastos f\xe1cilmente."})]}),(0,s.jsxs)(X,{defaultValue:"control",className:"w-full",children:[(0,s.jsxs)(ee,{className:"grid w-full grid-cols-3 mb-6",children:[(0,s.jsx)(et,{value:"control",children:"Control de gastos"}),(0,s.jsx)(et,{value:"reporting",children:"Reporter\xeda"}),(0,s.jsx)(et,{value:"data",children:"Exportar/Importar Data"})]}),(0,s.jsx)(ea,{value:"control",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsx)(U,{onAddExpense:e=>{var t;let a=(null===(t=e.category)||void 0===t?void 0:t.trim())?e.category.trim():tV,s={...e,category:a,id:(0,tl.Z)(),timestamp:new Date};a===tV||x.includes(a)||p(e=>[...e,a].sort()),m(e=>[...e,s].sort((e,t)=>{var a,s,r,l;let n=null!==(r=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==r?r:0;return(null!==(l=null===(s=G(t.timestamp))||void 0===s?void 0:s.getTime())&&void 0!==l?l:0)-n})),y.current&&y.current.focus()},categories:x.filter(e=>e!==tV),defaultCategoryKey:tV,productInputRef:y})}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(er,{expenses:d})})]})}),(0,s.jsx)(ea,{value:"reporting",children:(0,s.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,s.jsxs)(B,{className:"mb-4 md:mb-6",children:[(0,s.jsx)(Y,{children:(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"Filtros de Reporter\xeda"})}),(0,s.jsxs)(Q,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{htmlFor:"product-filter-select",className:"text-xs sm:text-sm",children:"Filtrar por Producto:"}),(0,s.jsxs)(ty,{onValueChange:w,value:b,disabled:!h,children:[(0,s.jsx)(tN,{id:"product-filter-select",className:"w-full mt-1",children:(0,s.jsx)(tv,{placeholder:"Seleccionar Producto",children:"all"===b?"Todos los Productos":b})}),(0,s.jsx)(tk,{children:I.map(e=>(0,s.jsx)(tC,{value:e,children:"all"===e?"Todos los Productos":e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{htmlFor:"category-filter-select",className:"text-xs sm:text-sm",children:"Filtrar por Categor\xeda:"}),(0,s.jsxs)(ty,{onValueChange:C,value:k,disabled:!h,children:[(0,s.jsx)(tN,{id:"category-filter-select",className:"w-full mt-1",children:(0,s.jsx)(tv,{placeholder:"Seleccionar Categor\xeda",children:"all"===k?"Todas las Categor\xedas":k})}),(0,s.jsx)(tk,{children:Z.map(e=>(0,s.jsx)(tC,{value:e,children:"all"===e?"Todas las Categor\xedas":e},e))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 items-end",children:[(0,s.jsxs)("div",{className:"md:col-span-1",children:[(0,s.jsx)(f,{htmlFor:"quick-range-select",className:"text-xs sm:text-sm",children:"Rango R\xe1pido:"}),(0,s.jsxs)(ty,{onValueChange:e=>P(e),value:T,disabled:!h,children:[(0,s.jsx)(tN,{id:"quick-range-select",className:"w-full mt-1",children:(0,s.jsx)(tv,{placeholder:"Seleccionar Rango"})}),(0,s.jsxs)(tk,{children:[(0,s.jsx)(tC,{value:"allTime",children:"Todo el tiempo"}),(0,s.jsx)(tC,{value:"7days",children:"\xdaltimos 7 d\xedas"}),(0,s.jsx)(tC,{value:"30days",children:"\xdaltimos 30 d\xedas"}),(0,s.jsx)(tC,{value:"90days",children:"\xdaltimos 90 d\xedas"}),(0,s.jsx)(tC,{value:"custom",children:"Personalizado"})]})]})]}),(0,s.jsxs)("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4 items-end",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{htmlFor:"start-date-filter",className:"text-xs sm:text-sm",children:"Fecha Desde:"}),(0,s.jsxs)(tT,{children:[(0,s.jsx)(tP,{asChild:!0,children:(0,s.jsxs)(u,{id:"start-date-filter",variant:"outline",className:(0,c.cn)("w-full justify-start text-left font-normal mt-1",!S&&"text-muted-foreground"),disabled:!h,children:[(0,s.jsx)(ti.Z,{className:"mr-2 h-4 w-4"}),S?(0,M.WU)(S,"PPP",{locale:O.es}):(0,s.jsx)("span",{children:"Seleccionar fecha"})]})}),(0,s.jsx)(tF,{className:"w-auto p-0",children:(0,s.jsx)(tR,{mode:"single",selected:S||void 0,onSelect:e=>W(_,e||null),initialFocus:!0})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{htmlFor:"end-date-filter",className:"text-xs sm:text-sm",children:"Fecha Hasta:"}),(0,s.jsxs)(tT,{children:[(0,s.jsx)(tP,{asChild:!0,children:(0,s.jsxs)(u,{id:"end-date-filter",variant:"outline",className:(0,c.cn)("w-full justify-start text-left font-normal mt-1",!R&&"text-muted-foreground"),disabled:!h,children:[(0,s.jsx)(ti.Z,{className:"mr-2 h-4 w-4"}),R?(0,M.WU)(R,"PPP",{locale:O.es}):(0,s.jsx)("span",{children:"Seleccionar fecha"})]})}),(0,s.jsx)(tF,{className:"w-auto p-0",children:(0,s.jsx)(tR,{mode:"single",selected:R||void 0,onSelect:e=>W(D,e||null),disabled:e=>!!S&&e<S,initialFocus:!0})})]})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(u,{onClick:()=>{w("all"),C("all"),P("allTime")},variant:"outline",className:"w-full sm:w-auto mt-2 sm:mt-0",disabled:!h,children:[(0,s.jsx)(td.Z,{className:"mr-2 h-4 w-4"})," Limpiar Filtros"]})})]})]}),(0,s.jsx)(eH,{expenses:A,startDate:el,endDate:en}),(0,s.jsx)(eX,{expenses:A,defaultCategoryKey:tV}),(0,s.jsxs)(B,{children:[(0,s.jsxs)(Y,{children:[(0,s.jsx)(J,{className:"text-lg sm:text-xl",children:"all"!==b&&"all"!==k?"Historial de ".concat(b," (").concat(k,")"):"all"!==b?"Historial de ".concat(b):"all"!==k?"Historial de ".concat(k):"Historial Completo de Gastos"}),(0,s.jsx)(q,{children:(n="",n="all"!==b&&"all"!==k?"Gastos para ".concat(b," (").concat(k,")"):"all"!==b?"Gastos para el producto ".concat(b):"all"!==k?"Gastos para la categor\xeda ".concat(k):"Todos los gastos registrados",o="",o=S&&R?" entre ".concat((0,M.WU)(S,"PPP",{locale:O.es})," y ").concat((0,M.WU)(R,"PPP",{locale:O.es})):S?" desde ".concat((0,M.WU)(S,"PPP",{locale:O.es})):R?" hasta ".concat((0,M.WU)(R,"PPP",{locale:O.es})):" (todo el tiempo)","".concat(n).concat(o,". Total: ").concat(L(K)))})]}),(0,s.jsx)(Q,{className:"px-0 sm:px-6 sm:pb-6",children:h?(0,s.jsx)(eS,{expenses:A,onDeleteExpense:e=>{m(t=>t.filter(t=>t.id!==e))},onEditExpense:e=>{N(e)},groupName:t,onDeleteGroup:l,groupTypeLabel:e,groupDisplayName:a,defaultCategoryKey:tV}):(0,s.jsx)(es,{className:"h-64 w-full"})})]})]})}),(0,s.jsx)(ea,{value:"data",children:(0,s.jsxs)(B,{children:[(0,s.jsxs)(Y,{children:[(0,s.jsx)(J,{children:"Exportar/Importar Data (CSV)"}),(0,s.jsx)(q,{children:"Exporta tus gastos a un archivo CSV o importa desde uno existente."})]}),(0,s.jsxs)(Q,{className:"flex flex-col sm:flex-row gap-2 sm:gap-4",children:[(0,s.jsx)("input",{type:"file",ref:j,onChange:e=>{if(!h||!e.target.files||0===e.target.files.length)return;let t=e.target.files[0],a=new FileReader;a.onload=e=>{var t;let a=null===(t=e.target)||void 0===t?void 0:t.result;if("string"==typeof a)try{let e=tx().parse(a,{header:!0,skipEmptyLines:!0}),t=[],s=new Set(x),r=0;e.errors.length>0&&(e.errors.forEach(e=>console.error("CSV Parsing Error:",e)),i({title:"Error de Formato CSV",description:"Se encontraron ".concat(e.errors.length," errores al leer el archivo. Verifica el formato."),variant:"destructive"})),e.data.forEach((e,a)=>{var l,n,o,i;let d=null===(l=e.Producto)||void 0===l?void 0:l.trim(),c=null===(n=e.Precio)||void 0===n?void 0:n.trim(),m=(null===(o=e.Categoria)||void 0===o?void 0:o.trim())||tV,u=null===(i=e.Timestamp)||void 0===i?void 0:i.trim(),x=parseFloat(c),p=G(u);if(!p&&"string"==typeof u){let e=u.match(/(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2})/);if(e){let t="".concat(e[3],"-").concat(e[2],"-").concat(e[1],"T").concat(e[4],":").concat(e[5],":00");p=G(t)}}if(!p&&"string"==typeof u){let e=u.match(/(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2}):(\d{2})/);if(e){let t="".concat(e[3],"-").concat(e[2],"-").concat(e[1],"T").concat(e[4],":").concat(e[5],":").concat(e[6]);p=G(t)}}if(!d||isNaN(x)||x<=0||!p){console.warn("Fila ".concat(a+2," omitida: Datos inv\xe1lidos (Producto: ").concat(d,", Precio: ").concat(c,", Timestamp: ").concat(u,", Fecha Parseada: ").concat(p,")")),r++;return}let f={id:(0,tl.Z)(),product:{name:d,value:0,color:""},price:x,category:m,timestamp:p};t.push(f),m!==tV&&m&&s.add(m)}),t.length>0&&(m(e=>[...e,...t].sort((e,t)=>{var a,s,r,l;let n=null!==(r=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==r?r:0;return(null!==(l=null===(s=G(t.timestamp))||void 0===s?void 0:s.getTime())&&void 0!==l?l:0)-n})),p(Array.from(s).sort())),i({title:"Importaci\xf3n Completa",description:"".concat(t.length," gastos importados. ").concat(r>0?"".concat(r," filas omitidas por datos inv\xe1lidos."):"")})}catch(e){console.error("Error al importar CSV:",e),i({title:"Error de Importaci\xf3n",description:"No se pudo procesar el archivo CSV.",variant:"destructive"})}finally{j.current&&(j.current.value="")}},a.onerror=e=>{console.error("Error al leer archivo:",e),i({title:"Error de Lectura",description:"No se pudo leer el archivo seleccionado.",variant:"destructive"}),j.current&&(j.current.value="")},a.readAsText(t)},accept:".csv",style:{display:"none"},id:"import-csv-input"}),h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u,{onClick:()=>{if(!h)return;let e=d.map(e=>({Producto:e.product.name,Precio:e.price,Categoria:e.category,Timestamp:e.timestamp instanceof Date?e.timestamp.toISOString():new Date(e.timestamp).toISOString()})),t=new Blob([tx().unparse(e,{header:!0})],{type:"text/csv;charset=utf-8;"});(0,tp.saveAs)(t,"gastos.csv"),i({title:"Exportaci\xf3n Completa",description:"Los datos de gastos se han exportado a gastos.csv."})},variant:"outline",className:"w-full sm:w-auto",children:[(0,s.jsx)(tc.Z,{className:"mr-2 h-4 w-4"})," Exportar a CSV"]}),(0,s.jsxs)(u,{onClick:()=>{h&&j.current&&j.current.click()},variant:"outline",className:"w-full sm:w-auto",children:[(0,s.jsx)(tm.Z,{className:"mr-2 h-4 w-4"})," Importar desde CSV"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es,{className:"h-10 w-full sm:w-[150px]"}),(0,s.jsx)(es,{className:"h-10 w-full sm:w-[170px]"})]})]})]})})]}),v&&h&&(0,s.jsx)(ta,{expense:v,onSave:e=>{var t;let a=(null===(t=e.category)||void 0===t?void 0:t.trim())?e.category.trim():tV,s={...e,category:a};m(e=>e.map(e=>e.id===s.id?s:e).sort((e,t)=>{var a,s,r,l;let n=null!==(r=null===(a=G(e.timestamp))||void 0===a?void 0:a.getTime())&&void 0!==r?r:0;return(null!==(l=null===(s=G(t.timestamp))||void 0===s?void 0:s.getTime())&&void 0!==l?l:0)-n})),a===tV||x.includes(a)||p(e=>[...e,a].sort()),N(null),i({title:"Gasto Actualizado",description:'El gasto "'.concat(s.product.name,'" ha sido actualizado.')})},onCancel:()=>{N(null)},categories:x.filter(e=>e!==tV),defaultCategoryKey:tV})]})]})}}},function(e){e.O(0,[219,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);