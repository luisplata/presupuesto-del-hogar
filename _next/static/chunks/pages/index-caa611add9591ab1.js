(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{8104:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>tc});var a=r(37876),s=r(14232),l=r(12770),o=r(60513),n=r(13810),i=r(88992),d=r(82987),c=r(47137),u=r(65579);let m=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),f=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:o=!1,...n}=e,i=o?d.DX:"button";return(0,a.jsx)(i,{className:(0,u.cn)(m({variant:s,size:l,className:r})),ref:t,...n})});f.displayName="Button";var x=r(59773);let p=(0,c.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(x.b,{ref:t,className:(0,u.cn)(p(),r),...s})});h.displayName=x.b.displayName;let g=i.Op,j=s.createContext({}),y=e=>{let{...t}=e;return(0,a.jsx)(j.Provider,{value:{name:t.name},children:(0,a.jsx)(i.xI,{...t})})},v=()=>{let e=s.useContext(j),t=s.useContext(b),{getFieldState:r,formState:a}=(0,i.xW)(),l=r(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...l}},b=s.createContext({}),N=s.forwardRef((e,t)=>{let{className:r,...l}=e,o=s.useId();return(0,a.jsx)(b.Provider,{value:{id:o},children:(0,a.jsx)("div",{ref:t,className:(0,u.cn)("space-y-2",r),...l})})});N.displayName="FormItem";let w=s.forwardRef((e,t)=>{let{className:r,...s}=e,{error:l,formItemId:o}=v();return(0,a.jsx)(h,{ref:t,className:(0,u.cn)(l&&"text-destructive",r),htmlFor:o,...s})});w.displayName="FormLabel";let k=s.forwardRef((e,t)=>{let{...r}=e,{error:s,formItemId:l,formDescriptionId:o,formMessageId:n}=v();return(0,a.jsx)(d.DX,{ref:t,id:l,"aria-describedby":s?"".concat(o," ").concat(n):"".concat(o),"aria-invalid":!!s,...r})});k.displayName="FormControl",s.forwardRef((e,t)=>{let{className:r,...s}=e,{formDescriptionId:l}=v();return(0,a.jsx)("p",{ref:t,id:l,className:(0,u.cn)("text-sm text-muted-foreground",r),...s})}).displayName="FormDescription";let C=s.forwardRef((e,t)=>{var r;let{className:s,children:l,...o}=e,{error:n,formMessageId:i}=v(),d=n?String(null!=(r=null==n?void 0:n.message)?r:""):l;return d?(0,a.jsx)("p",{ref:t,id:i,className:(0,u.cn)("text-sm font-medium text-destructive",s),...o,children:d}):null});C.displayName="FormMessage";let E=s.forwardRef((e,t)=>{let{className:r,type:s,...l}=e;return(0,a.jsx)("input",{type:s,className:(0,u.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...l})});E.displayName="Input";var S=r(31928),D=r(44405),F=r(5686),R=r(93711),_=r(13356),T=r(50029),P=r(66516),M=r(94548),A=r(63473),I=r(73088),L=r(23630),G=r(59617);let H=e=>{if(e instanceof Date&&(0,D.f)(e))return e;if("string"==typeof e){let t=(0,F.H)(e);if((0,D.f)(t))return t}if("number"==typeof e){let t=new Date(e);if((0,D.f)(t))return t}return console.warn("Fecha inv\xe1lida encontrada:",e),null},O=(e,t)=>{let r,a,s=new Date;switch(t){case"week":r=(0,R.k)(s,{weekStartsOn:1}),a=(0,_.$)(s,{weekStartsOn:1});break;case"month":r=(0,T.w)(s),a=(0,P.p)(s);break;case"bi-weekly":let l=(0,T.w)(s),o=(0,P.p)(s),n=(0,M.D)(new Date(s.getFullYear(),s.getMonth(),15));s<=n?(r=(0,A.o)(l),a=n):(r=(0,A.o)(new Date(s.getFullYear(),s.getMonth(),16)),a=(0,M.D)(o));break;default:return[]}return r=(0,A.o)(r),a=(0,M.D)(a),e.filter(e=>{let t=H(e.timestamp);return t&&(0,I.v)(t,{start:r,end:a})})},K=e=>e.reduce((e,t)=>e+(t.price||0),0),z=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}),U=e=>((null==e||isNaN(e))&&(e=0),z.format(e)),V=e=>{if(null==e)return 0;let t=parseInt(String(e).replace(/[^\d]/g,""),10);return isNaN(t)?0:t},B=e=>{let t=H(e);if(!t)return"Fecha inv\xe1lida";let r=G.es;try{return(0,L.GP)(t,"dd/MM/yyyy HH:mm",{locale:r})}catch(r){return console.error("Error al formatear fecha:",r,"Fecha de entrada:",e,"Fecha parseada:",t),t.toLocaleDateString("es-ES")+" "+t.toLocaleTimeString("es-ES")}},W=()=>o.Ik({product:o.Yj().min(1,{message:"El nombre del producto no puede estar vac\xedo."}),price:o.au.number().positive({message:"El precio debe ser un n\xfamero positivo."}),category:o.Yj().optional()});function Y(e){let{onAddExpense:t,categories:r,defaultCategoryKey:l}=e,{toast:o}=(0,S.dj)(),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),x=(0,s.useMemo)(()=>W(),[]),p=(0,i.mN)({resolver:(0,n.u)(x),defaultValues:{product:"",price:0,category:""}}),h=p.watch("price");(0,s.useEffect)(()=>{"number"!=typeof h||isNaN(h)?m(U(0)):m(U(h))},[h]);let j=(e,t)=>{let r=V(e.target.value);m(U(isNaN(r)?0:r)),t(isNaN(r)?0:r)},v=(e,t)=>{m(U(isNaN(t)?0:t)),e()};async function b(e){c(!0);try{var r;let a=(null==(r=e.category)?void 0:r.trim())||l;await new Promise(e=>setTimeout(e,100)),t({product:e.product,price:e.price,category:a}),o({title:"Gasto agregado",description:"Producto: ".concat(e.product,", Precio: ").concat(U(e.price),", Categor\xeda: ").concat(a)}),p.reset({product:"",price:0,category:""}),m(U(0))}catch(e){console.error("Error al agregar gasto:",e),o({title:"Error",description:"No se pudo agregar el gasto.",variant:"destructive"})}finally{c(!1)}}return(0,a.jsx)(g,{...p,children:(0,a.jsxs)("form",{onSubmit:p.handleSubmit(b),className:"space-y-4 rounded-lg border bg-card p-6 shadow-sm",children:[(0,a.jsx)(y,{control:p.control,name:"product",render:e=>{let{field:t}=e;return(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:"Producto"}),(0,a.jsx)(k,{children:(0,a.jsx)(E,{placeholder:"Ej: Caf\xe9",...t})}),(0,a.jsx)(C,{})]})}}),(0,a.jsx)(y,{control:p.control,name:"price",render:e=>{let{field:t}=e;return(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:"Precio (COP)"}),(0,a.jsx)(k,{children:(0,a.jsx)(E,{type:"text",placeholder:U(0),...t,value:u,onChange:e=>j(e,t.onChange),onBlur:()=>v(t.onBlur,t.value),inputMode:"decimal"})}),(0,a.jsx)(C,{})]})}}),(0,a.jsx)(y,{control:p.control,name:"category",render:e=>{let{field:t}=e;return(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:"Categor\xeda (Opcional)"}),(0,a.jsx)(k,{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{placeholder:"Ej: Comida",...t,list:"category-suggestions",autoComplete:"off"}),(0,a.jsx)("datalist",{id:"category-suggestions",children:r.map(e=>(0,a.jsx)("option",{value:e},e))})]})}),(0,a.jsx)(C,{})]})}}),(0,a.jsx)(f,{type:"submit",disabled:d,children:d?"Agregando...":"Agregar Gasto"})]})})}let J=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,u.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});J.displayName="Card";let q=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,u.cn)("flex flex-col space-y-1.5 p-6",r),...s})});q.displayName="CardHeader";let X=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,u.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});X.displayName="CardTitle";let Z=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,u.cn)("text-sm text-muted-foreground",r),...s})});Z.displayName="CardDescription";let Q=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,u.cn)("p-6 pt-0",r),...s})});Q.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,u.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter";var $=r(41592);let ee=$.bL,et=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)($.B8,{ref:t,className:(0,u.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...s})});et.displayName=$.B8.displayName;let er=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)($.l9,{ref:t,className:(0,u.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...s})});er.displayName=$.l9.displayName;let ea=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)($.UC,{ref:t,className:(0,u.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...s})});function es(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,u.cn)("animate-pulse rounded-md bg-muted",t),...r})}function el(e){let{expenses:t}=e,[r,l]=(0,s.useState)(!1),[o,n]=(0,s.useState)(null),[i,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[m,f]=(0,s.useState)(0),[x,p]=(0,s.useState)(0),[h,g]=(0,s.useState)(0);(0,s.useEffect)(()=>{l(!0);let e=O(t,"week"),r=O(t,"bi-weekly"),a=O(t,"month");n(K(e)),d(K(r)),u(K(a)),f(e.length),p(r.length),g(a.length)},[t]);let j=e=>{let t,s,l,n;switch(e){case"week":t=o,s=m,l="Total Gastado esta Semana",n="semana";break;case"bi-weekly":t=i,s=x,l="Total Gastado esta Quincena",n="quincena";break;case"month":t=c,s=h,l="Total Gastado este Mes",n="mes"}return r&&null!==t?(0,a.jsxs)("div",{className:"mt-4 p-4 rounded-md border bg-card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:l}),(0,a.jsx)("p",{className:"text-2xl font-bold text-primary",children:U(t)}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s," gasto(s) esta ",n,"."]})]}):(0,a.jsxs)("div",{className:"mt-4 p-4 rounded-md border bg-card space-y-2",children:[(0,a.jsx)(es,{className:"h-6 w-3/4"}),(0,a.jsx)(es,{className:"h-8 w-1/2"}),(0,a.jsx)(es,{className:"h-4 w-1/4"})]})};return(0,a.jsxs)(J,{children:[(0,a.jsx)(q,{children:(0,a.jsx)(X,{children:r?"Resumen de Gastos":(0,a.jsx)(es,{className:"h-6 w-1/2"})})}),(0,a.jsx)(Q,{children:(0,a.jsxs)(ee,{defaultValue:"week",className:"w-full",children:[(0,a.jsx)(et,{className:"grid w-full grid-cols-3",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(er,{value:"week",children:"Semana"}),(0,a.jsx)(er,{value:"bi-weekly",children:"Quincena"}),(0,a.jsx)(er,{value:"month",children:"Mes"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es,{className:"h-9 w-full"}),(0,a.jsx)(es,{className:"h-9 w-full"}),(0,a.jsx)(es,{className:"h-9 w-full"})]})}),(0,a.jsx)(ea,{value:"week",children:j("week")}),(0,a.jsx)(ea,{value:"bi-weekly",children:j("bi-weekly")}),(0,a.jsx)(ea,{value:"month",children:j("month")})]})})]})}ea.displayName=$.UC.displayName;let eo=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,u.cn)("w-full caption-bottom text-sm",r),...s})})});eo.displayName="Table";let en=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,u.cn)("[&_tr]:border-b",r),...s})});en.displayName="TableHeader";let ei=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,u.cn)("[&_tr:last-child]:border-0",r),...s})});ei.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,u.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let ed=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,u.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});ed.displayName="TableRow";let ec=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,u.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});ec.displayName="TableHead";let eu=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,u.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});eu.displayName="TableCell";let em=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,u.cn)("mt-4 text-sm text-muted-foreground",r),...s})});em.displayName="TableCaption";var ef=r(66388),ex=r(40435);let ep=ex.bL,eh=ex.l9,eg=ex.ZL,ej=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ex.hJ,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s,ref:t})});ej.displayName=ex.hJ.displayName;let ey=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsxs)(eg,{children:[(0,a.jsx)(ej,{}),(0,a.jsx)(ex.UC,{ref:t,className:(0,u.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s})]})});ey.displayName=ex.UC.displayName;let ev=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};ev.displayName="AlertDialogHeader";let eb=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,u.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};eb.displayName="AlertDialogFooter";let eN=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ex.hE,{ref:t,className:(0,u.cn)("text-lg font-semibold",r),...s})});eN.displayName=ex.hE.displayName;let ew=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ex.VY,{ref:t,className:(0,u.cn)("text-sm text-muted-foreground",r),...s})});ew.displayName=ex.VY.displayName;let ek=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ex.rc,{ref:t,className:(0,u.cn)(m(),r),...s})});ek.displayName=ex.rc.displayName;let eC=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ex.ZD,{ref:t,className:(0,u.cn)(m({variant:"outline"}),"mt-2 sm:mt-0",r),...s})});eC.displayName=ex.ZD.displayName;let eE=(0,c.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eS(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,u.cn)(eE({variant:r}),t),...s})}function eD(e){let{expenses:t,title:r,caption:s,onDeleteExpense:l,groupName:o,groupDisplayName:n,onDeleteGroup:i,groupTypeLabel:d,defaultCategoryKey:c}=e,{toast:u}=(0,S.dj)(),m=null!=r?r:"Historial de Gastos",x="Grupo",p=e=>{l(e),u({title:"Gasto eliminado",description:"El gasto ha sido eliminado exitosamente."})},h=e=>{i&&(i(e),u({title:"".concat(d||x," eliminado"),description:'Todas las entradas para "'.concat(n||e,'" han sido eliminadas.')}))};if(!t||0===t.length)return(0,a.jsxs)(J,{children:[(0,a.jsx)(q,{children:(0,a.jsx)(X,{children:m})}),(0,a.jsx)(Q,{children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No hay gastos para mostrar."})})]});let g=!!i&&!!o;return(0,a.jsxs)(J,{children:[(0,a.jsxs)(q,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(X,{children:m}),g&&o&&(0,a.jsxs)(ep,{children:[(0,a.jsx)(eh,{asChild:!0,children:(0,a.jsxs)(f,{variant:"destructive",size:"sm",children:[(0,a.jsx)(ef.A,{className:"mr-2 h-4 w-4"})," Eliminar ",d," (",n||o,")"]})}),(0,a.jsxs)(ey,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(eN,{children:"\xbfEst\xe1s seguro?"}),(0,a.jsxs)(ew,{children:["Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente todas las entradas para ",(null==d?void 0:d.toLowerCase())||x.toLowerCase(),' "',n||o,'".']})]}),(0,a.jsxs)(eb,{children:[(0,a.jsx)(eC,{children:"Cancelar"}),(0,a.jsxs)(ek,{onClick:()=>h(o),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:["Eliminar ",d]})]})]})]})]}),(0,a.jsx)(Q,{children:(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{children:null!=s?s:"Lista de todos tus gastos."}),(0,a.jsx)(en,{children:(0,a.jsxs)(ed,{children:[(0,a.jsx)(ec,{children:"Producto"}),(0,a.jsx)(ec,{children:"Precio"}),(0,a.jsx)(ec,{children:"Categor\xeda"}),(0,a.jsx)(ec,{children:"Fecha y Hora"}),(0,a.jsx)(ec,{className:"text-right",children:"Acciones"})]})}),(0,a.jsx)(ei,{children:t.sort((e,t)=>{let r=e.timestamp instanceof Date?e.timestamp.getTime():new Date(e.timestamp).getTime();return(t.timestamp instanceof Date?t.timestamp.getTime():new Date(t.timestamp).getTime())-r}).map(e=>(0,a.jsxs)(ed,{children:[(0,a.jsx)(eu,{className:"font-medium",children:e.product}),(0,a.jsx)(eu,{children:U(e.price)}),(0,a.jsx)(eu,{children:(0,a.jsxs)(eS,{variant:e.category===c?"secondary":"outline",children:[e.category," "]})}),(0,a.jsx)(eu,{children:B(e.timestamp)})," ",(0,a.jsx)(eu,{className:"text-right",children:(0,a.jsxs)(ep,{children:[(0,a.jsx)(eh,{asChild:!0,children:(0,a.jsxs)(f,{variant:"ghost",size:"icon",children:[(0,a.jsx)(ef.A,{className:"h-4 w-4 text-destructive"}),(0,a.jsx)("span",{className:"sr-only",children:"Eliminar"})]})}),(0,a.jsxs)(ey,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(eN,{children:"\xbfEst\xe1s seguro?"}),(0,a.jsxs)(ew,{children:['Esta acci\xf3n no se puede deshacer. Esto eliminar\xe1 permanentemente el gasto "',e.product,'" con precio ',U(e.price),"."]})]}),(0,a.jsxs)(eb,{children:[(0,a.jsx)(eC,{children:"Cancelar"}),(0,a.jsx)(ek,{onClick:()=>p(e.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar Gasto"})]})]})]})})]},e.id))})]})})]})}var eF=r(14871),eR=r(34553),e_=r(33400),eT=r(47085);let eP=eF.bL;eF.YJ;let eM=eF.WT,eA=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(eF.l9,{ref:t,className:(0,u.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...l,children:[s,(0,a.jsx)(eF.In,{asChild:!0,children:(0,a.jsx)(eR.A,{className:"h-4 w-4 opacity-50"})})]})});eA.displayName=eF.l9.displayName;let eI=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(eF.PP,{ref:t,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(e_.A,{className:"h-4 w-4"})})});eI.displayName=eF.PP.displayName;let eL=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(eF.wn,{ref:t,className:(0,u.cn)("flex cursor-default items-center justify-center py-1",r),...s,children:(0,a.jsx)(eR.A,{className:"h-4 w-4"})})});eL.displayName=eF.wn.displayName;let eG=s.forwardRef((e,t)=>{let{className:r,children:s,position:l="popper",...o}=e;return(0,a.jsx)(eF.ZL,{children:(0,a.jsxs)(eF.UC,{ref:t,className:(0,u.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...o,children:[(0,a.jsx)(eI,{}),(0,a.jsx)(eF.LM,{className:(0,u.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(eL,{})]})})});eG.displayName=eF.UC.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(eF.JU,{ref:t,className:(0,u.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=eF.JU.displayName;let eH=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(eF.q7,{ref:t,className:(0,u.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eF.VF,{children:(0,a.jsx)(eT.A,{className:"h-4 w-4"})})}),(0,a.jsx)(eF.p4,{children:s})]})});eH.displayName=eF.q7.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(eF.wv,{ref:t,className:(0,u.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=eF.wv.displayName;let eO=e=>["all",...Array.from(new Set(e.map(e=>e.product))).sort()],eK=(e,t)=>"all"===t?e:e.filter(e=>e.product===t);function ez(e){let{expenses:t,onDeleteExpense:r,onDeleteProduct:l,defaultCategoryKey:o}=e,[n,i]=(0,s.useState)("all"),d=(0,s.useMemo)(()=>eO(t),[t]),c=(0,s.useMemo)(()=>eK(t,n),[t,n]),u=(0,s.useCallback)(e=>{void 0!==e&&i(e)},[]),m="all"===n?"Todos los Productos":n,f="all"===n?"Historial Completo por Producto":"Historial de ".concat(n),x="all"===n?"Todos los gastos registrados.":"Gastos registrados para ".concat(n,".");return(0,a.jsxs)(J,{children:[(0,a.jsx)(q,{children:(0,a.jsx)(X,{children:"Historial por Producto"})}),(0,a.jsxs)(Q,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h,{htmlFor:"product-select",children:"Seleccionar Producto:"}),(0,a.jsxs)(eP,{onValueChange:u,value:n,children:[(0,a.jsx)(eA,{id:"product-select",className:"w-full md:w-[280px] mt-1",children:(0,a.jsx)(eM,{placeholder:"Seleccionar Producto",children:m})}),(0,a.jsx)(eG,{children:d.map(e=>(0,a.jsx)(eH,{value:e,children:"all"===e?"Todos los Productos":e},e))})]})]}),(0,a.jsx)(eD,{expenses:c,onDeleteExpense:r,groupName:"all"!==n?n:void 0,onDeleteGroup:"all"!==n?l:void 0,groupTypeLabel:"all"!==n?"Producto":void 0,groupDisplayName:"all"!==n?n:void 0,title:f,caption:x,defaultCategoryKey:o})]})]})}let eU=(e,t)=>["all",...Array.from(new Set(e.map(e=>e.category||t))).sort()],eV=(e,t,r)=>"all"===t?e:e.filter(e=>(e.category||r)===t);function eB(e){let{expenses:t,onDeleteExpense:r,onDeleteCategory:l,defaultCategoryKey:o}=e,[n,i]=(0,s.useState)("all"),d=(0,s.useMemo)(()=>eU(t,o),[t,o]),c=(0,s.useMemo)(()=>eV(t,n,o),[t,n,o]),u=(0,s.useCallback)(e=>{void 0!==e&&i(e)},[]),m="all"===n?"Todas las Categor\xedas":n,f="all"===n?"Historial Completo por Categor\xeda":"Historial de ".concat(m),x="all"===n?"Todos los gastos registrados.":"Gastos registrados para la categor\xeda ".concat(m,".");return(0,a.jsxs)(J,{children:[(0,a.jsx)(q,{children:(0,a.jsx)(X,{children:"Historial por Categor\xeda"})}),(0,a.jsxs)(Q,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h,{htmlFor:"category-select",children:"Seleccionar Categor\xeda:"}),(0,a.jsxs)(eP,{onValueChange:u,value:n,children:[(0,a.jsx)(eA,{id:"category-select",className:"w-full md:w-[280px] mt-1",children:(0,a.jsx)(eM,{placeholder:"Seleccionar Categor\xeda",children:m})}),(0,a.jsx)(eG,{children:d.map(e=>(0,a.jsx)(eH,{value:e,children:"all"===e?"Todas las Categor\xedas":e},e))})]})]}),(0,a.jsx)(eD,{expenses:c,onDeleteExpense:r,groupName:"all"!==n?n:void 0,onDeleteGroup:"all"!==n?l:void 0,groupTypeLabel:"all"!==n?"Categor\xeda":void 0,groupDisplayName:m,title:f,caption:x,defaultCategoryKey:o})]})]})}var eW=r(64085),eY=r(14210),eJ=r(84211),eq=r(4356),eX=r(44247),eZ=r(94286),eQ=r(87113),e$=r(90922),e0=r(66512);let e1={light:"",dark:".dark"},e2=s.createContext(null);function e5(){let e=s.useContext(e2);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let e4=s.forwardRef((e,t)=>{let{id:r,className:l,children:o,config:n,...i}=e,d=s.useId(),c="chart-".concat(r||d.replace(/:/g,""));return(0,a.jsx)(e2.Provider,{value:{config:n},children:(0,a.jsxs)("div",{"data-chart":c,ref:t,className:(0,u.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...i,children:[(0,a.jsx)(e3,{id:c,config:n}),(0,a.jsx)(eW.u,{children:o})]})})});e4.displayName="Chart";let e3=e=>{let{id:t,config:r}=e,s=Object.entries(r).filter(e=>{let[,t]=e;return t.theme||t.color});return s.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(e1).map(e=>{let[r,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[a,s]=e,l=(null==(t=s.theme)?void 0:t[r])||s.color;return l?"  --color-".concat(a,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},e8=e$.m,e6=s.forwardRef((e,t)=>{let{active:r,payload:l,className:o,indicator:n="dot",hideLabel:i=!1,hideIndicator:d=!1,label:c,labelFormatter:m,labelClassName:f,formatter:x,color:p,nameKey:h,labelKey:g}=e,{config:j}=e5(),y=s.useMemo(()=>{var e;if(i||!(null==l?void 0:l.length))return null;let[t]=l,r="".concat(g||t.dataKey||t.name||"value"),s=e9(j,t,r),o=g||"string"!=typeof c?null==s?void 0:s.label:(null==(e=j[c])?void 0:e.label)||c;return m?(0,a.jsx)("div",{className:(0,u.cn)("font-medium",f),children:m(o,l)}):o?(0,a.jsx)("div",{className:(0,u.cn)("font-medium",f),children:o}):null},[c,m,l,i,f,j,g]);if(!r||!(null==l?void 0:l.length))return null;let v=1===l.length&&"dot"!==n;return(0,a.jsxs)("div",{ref:t,className:(0,u.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",o),children:[v?null:y,(0,a.jsx)("div",{className:"grid gap-1.5",children:l.map((e,t)=>{let r="".concat(h||e.name||e.dataKey||"value"),s=e9(j,e,r),l=p||e.payload.fill||e.color;return(0,a.jsx)("div",{className:(0,u.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:x&&(null==e?void 0:e.value)!==void 0&&e.name?x(e.value,e.name,e,t,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==s?void 0:s.icon)?(0,a.jsx)(s.icon,{}):!d&&(0,a.jsx)("div",{className:(0,u.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":v&&"dashed"===n}),style:{"--color-bg":l,"--color-border":l}}),(0,a.jsxs)("div",{className:(0,u.cn)("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[v?y:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==s?void 0:s.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function e9(e,t,r){if("object"!=typeof t||null===t)return;let a="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,s=r;return r in t&&"string"==typeof t[r]?s=t[r]:a&&r in a&&"string"==typeof a[r]&&(s=a[r]),s in e?e[s]:e[r]}e6.displayName="ChartTooltip",e0.s,s.forwardRef((e,t)=>{let{className:r,hideIcon:s=!1,payload:l,verticalAlign:o="bottom",nameKey:n}=e,{config:i}=e5();return(null==l?void 0:l.length)?(0,a.jsx)("div",{ref:t,className:(0,u.cn)("flex items-center justify-center gap-4","top"===o?"pb-3":"pt-3",r),children:l.map(e=>{let t="".concat(n||e.dataKey||"value"),r=e9(i,e,t);return(0,a.jsxs)("div",{className:(0,u.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==r?void 0:r.icon)&&!s?(0,a.jsx)(r.icon,{}):(0,a.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==r?void 0:r.label]},e.value)})}):null}).displayName="ChartLegend";let e7=(e,t)=>{let r=new Date,a=new Date(r);a.setDate(r.getDate()-t+1),a.setHours(0,0,0,0);let s={},l={},o=new Set,n=G.es,i=new Date(a);for(;i<=r;){let e=(0,L.GP)(i,"yyyy-MM-dd");s[e]={total:0,products:{}},o.add(e),i.setDate(i.getDate()+1)}return e.forEach(e=>{let t=e.timestamp instanceof Date?e.timestamp:new Date(e.timestamp);if(t.setHours(0,0,0,0),t>=a&&t<=r){let r=(0,L.GP)(t,"yyyy-MM-dd"),a=e.product;l[a]||(l[a]=e.product),s[r]||(s[r]={total:0,products:{}}),s[r].products[a]=(s[r].products[a]||0)+e.price,s[r].total+=e.price}}),{data:Array.from(o).map(e=>{let t=s[e],r=(0,L.GP)(new Date(e+"T00:00:00"),"dd MMM",{locale:n}),a=t?t.products:{};return{date:r,_rawDate:e,total:t?t.total:0,...a}}).sort((e,t)=>e._rawDate.localeCompare(t._rawDate)).map(e=>{let t={...e};return Object.keys(l).forEach(e=>{e in t||(t[e]=0)}),t}),productKeys:l}},te=e=>{let t={};return Object.keys(e).forEach(r=>{let a=Math.floor(360*Math.random()),s=Math.floor(41*Math.random())+50,l=Math.floor(31*Math.random())+50,o="hsl(".concat(a,", ").concat(s,"%, ").concat(l,"%)");t[r]={label:e[r],color:o}}),t};function tt(e){let{expenses:t}=e,[r,l]=(0,s.useState)(!1),[o,n]=(0,s.useState)([]),[i,d]=(0,s.useState)({}),[c,u]=(0,s.useState)([]),[m,f]=(0,s.useState)({}),[x,p]=(0,s.useState)([]),[h,g]=(0,s.useState)({});(0,s.useEffect)(()=>{l(!0);let e=e7(t,7);n(e.data),d(e.productKeys);let r=e7(t,30);u(r.data),f(r.productKeys);let a=e7(t,90);p(a.data),g(a.productKeys)},[t]);let j=(e,l,o)=>{let n=(0,s.useMemo)(()=>te(l),[l]),i=Object.keys(l);if(!r)return(0,a.jsxs)("div",{className:"mt-4 p-4 rounded-md border bg-card space-y-2 min-h-[350px]",children:[(0,a.jsx)(es,{className:"h-6 w-3/4 mb-4"}),(0,a.jsx)(es,{className:"h-[300px] w-full"})]});if(0===e.length||e.every(e=>0===e.total)){let e=0===t.length?"Agrega gastos para ver el gr\xe1fico.":"No hay gastos en los \xfaltimos ".concat(o," d\xedas.");return(0,a.jsx)("div",{className:"mt-4 p-4 rounded-md border bg-card text-center min-h-[350px] flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:e})})}return(0,a.jsx)(e4,{config:n,className:"min-h-[350px] w-full mt-4",children:(0,a.jsx)(eW.u,{width:"100%",height:350,children:(0,a.jsxs)(eY.b,{data:e,margin:{top:5,right:10,left:10,bottom:5},children:[(0,a.jsx)(eJ.d,{vertical:!1,strokeDasharray:"3 3"}),(0,a.jsx)(eq.W,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8}),(0,a.jsx)(eX.h,{tickFormatter:e=>U(e),tickLine:!1,axisLine:!1,tickMargin:8,width:80}),(0,a.jsx)(e8,{cursor:!0,content:(0,a.jsx)(e6,{nameKey:"name",formatter:(e,t,r)=>{if("total"===r.dataKey||"_rawDate"===r.dataKey||0>=Number(r.value))return null;let s=r.name;return(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,a.jsxs)("span",{className:"flex items-center mr-2",children:[(0,a.jsx)("span",{className:"w-2.5 h-2.5 rounded-full mr-1.5",style:{backgroundColor:r.color}}),s,":"]}),(0,a.jsx)("span",{className:"ml-2 font-semibold",children:U(e)})]})},labelFormatter:(e,t)=>{let r=t&&t.length>0?t[0].payload:null,s=r?r.total:0;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-semibold mb-1",children:e}),(0,a.jsxs)("div",{className:"text-muted-foreground border-t pt-1 mt-1",children:["Total D\xeda: ",U(s)]})]})},className:"min-w-[150px]"})}),i.map(e=>(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)(eZ.G,{type:"linear",dataKey:e,stackId:"a",stroke:"none",fill:"var(--color-".concat(e,")"),fillOpacity:.6,name:l[e]}),(0,a.jsx)(eQ.N,{type:"linear",dataKey:e,stroke:"var(--color-".concat(e,")"),strokeWidth:2,dot:!1,name:l[e]})]},e))]})})})};return(0,a.jsxs)(J,{children:[(0,a.jsx)(q,{children:(0,a.jsx)(X,{children:"An\xe1lisis de Gastos por D\xeda y Producto (Gr\xe1fico de \xc1rea Apilada)"})}),(0,a.jsx)(Q,{children:(0,a.jsxs)(ee,{defaultValue:"7days",className:"w-full",children:[(0,a.jsxs)(et,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(er,{value:"7days",children:"\xdaltimos 7 D\xedas"}),(0,a.jsx)(er,{value:"30days",children:"\xdaltimos 30 D\xedas"}),(0,a.jsx)(er,{value:"90days",children:"\xdaltimos 90 D\xedas"})]}),(0,a.jsx)(ea,{value:"7days",children:j(o,i,"7")}),(0,a.jsx)(ea,{value:"30days",children:j(c,m,"30")}),(0,a.jsx)(ea,{value:"90days",children:j(x,h,"90")})]})})]})}let tr=(e,t)=>{try{let r=window.localStorage.getItem(e);return r?JSON.parse(r):t}catch(r){if(r instanceof SyntaxError&&""===window.localStorage.getItem(e))return t;return console.error("Error reading localStorage key “".concat(e,"”:"),r),t}},ta=function(e,t){let[r,a]=(0,s.useState)(t),[l,o]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{o(!0)},[]),(0,s.useEffect)(()=>{l&&a(tr(e,t))},[e,l]),[l?r:t,(0,s.useCallback)(t=>{try{a(r=>{let a=t instanceof Function?t(r):t;return window.localStorage.setItem(e,JSON.stringify(a)),a})}catch(t){console.error("Error setting localStorage key “".concat(e,"”:"),t)}},[e])]};var ts=r(57186),tl=r(98191),to=r(75866),tn=r(77328),ti=r.n(tn);let td="no definido";function tc(){let{toast:e}=(0,S.dj)(),[t,r]=ta("expenses",[]),[o,n]=ta("categories",[td]),[i,d]=(0,s.useState)(!1),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{d(!0)},[]),(0,s.useEffect)(()=>{o.includes(td)||n(e=>[...e,td].sort())},[o,n]);let u=e=>{r(t=>t.filter(t=>t.id!==e))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ti(),{children:[(0,a.jsx)("title",{children:"Control de Gastos"}),(0,a.jsx)("meta",{name:"description",content:"Registra y analiza tus gastos f\xe1cilmente."})]}),(0,a.jsxs)("main",{className:"container mx-auto p-4 min-h-screen",children:[(0,a.jsxs)("header",{className:"mb-8 text-center relative",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Control de Gastos"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Registra y analiza tus gastos f\xe1cilmente."})]}),(0,a.jsxs)(ee,{defaultValue:"control",className:"w-full",children:[(0,a.jsxs)(et,{className:"grid w-full grid-cols-3 mb-6",children:[(0,a.jsx)(er,{value:"control",children:"Control de gastos"}),(0,a.jsx)(er,{value:"reporting",children:"Reporter\xeda"}),(0,a.jsx)(er,{value:"data",children:"Exportar/Importar Data"})]}),(0,a.jsx)(ea,{value:"control",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"md:col-span-1",children:(0,a.jsx)(Y,{onAddExpense:e=>{var t;let a=(null==(t=e.category)?void 0:t.trim())?e.category.trim():td,s={...e,category:a,id:(0,ts.A)(),timestamp:new Date};a===td||o.includes(a)||n(e=>[...e,a].sort()),r(e=>[...e,s].sort((e,t)=>{var r,a,s,l;let o=null!=(s=null==(r=H(e.timestamp))?void 0:r.getTime())?s:0;return(null!=(l=null==(a=H(t.timestamp))?void 0:a.getTime())?l:0)-o}))},categories:o.filter(e=>e!==td),defaultCategoryKey:td})}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)(el,{expenses:t})})]})}),(0,a.jsx)(ea,{value:"reporting",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(tt,{expenses:t}),(0,a.jsx)(ez,{expenses:t,onDeleteExpense:u,onDeleteProduct:e=>{r(t=>t.filter(t=>t.product!==e))},defaultCategoryKey:td}),(0,a.jsx)(eB,{expenses:t,onDeleteExpense:u,onDeleteCategory:e=>{r(t=>t.filter(t=>t.category!==e)),e!==td&&o.includes(e)&&n(t=>t.filter(t=>t!==e))},defaultCategoryKey:td})]})}),(0,a.jsx)(ea,{value:"data",children:(0,a.jsxs)(J,{children:[(0,a.jsxs)(q,{children:[(0,a.jsx)(X,{children:"Exportar/Importar Data"}),(0,a.jsx)(Z,{children:"Exporta tus datos de gastos actuales o importa datos desde un archivo Excel."})]}),(0,a.jsxs)(Q,{className:"flex flex-col sm:flex-row gap-4",children:[i&&(0,a.jsxs)(f,{onClick:()=>{let e=t.sort((e,t)=>{var r,a,s,l;let o=null!=(s=null==(r=H(e.timestamp))?void 0:r.getTime())?s:0;return(null!=(l=null==(a=H(t.timestamp))?void 0:a.getTime())?l:0)-o}).map(e=>({Producto:e.product,Precio:e.price,Categoría:e.category,"Fecha y Hora":B(e.timestamp)})),r=l.Wp.json_to_sheet(e),a=l.Wp.book_new();l.Wp.book_append_sheet(a,r,"Gastos"),r["!cols"]=[{wch:20},{wch:10},{wch:15},{wch:25}];let s=new Blob([l.M9(a,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),o=new Date,n="".concat(o.getFullYear(),"-").concat((o.getMonth()+1).toString().padStart(2,"0"),"-").concat(o.getDate().toString().padStart(2,"0")),i=document.createElement("a");i.href=URL.createObjectURL(s),i.download="gastos_".concat(n,".xlsx"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(i.href)},variant:"outline",children:[(0,a.jsx)(tl.A,{className:"mr-2 h-4 w-4"}),"Exportar a Excel"]}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f,{onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()},variant:"outline",children:[(0,a.jsx)(to.A,{className:"mr-2 h-4 w-4"}),"Importar desde Excel"]}),(0,a.jsx)("input",{type:"file",ref:c,onChange:t=>{var a;let s=null==(a=t.target.files)?void 0:a[0];if(!s)return;let i=new FileReader;i.onload=t=>{try{var a;let s=null==(a=t.target)?void 0:a.result,i=l.LF(s,{type:"binary"}),d=i.SheetNames[0],c=i.Sheets[d],u=l.Wp.sheet_to_json(c),m="Producto",f="Precio",x="Categor\xeda",p="Fecha y Hora",h=[],g=new Set(o),j=0;u.forEach((e,t)=>{if(!(m in e)||!(f in e)||!(p in e)){console.warn("Fila ".concat(t+2," omitida: Faltan columnas requeridas (Producto, Precio, Fecha y Hora).")),j++;return}let r=String(e[m]),a=Number(e[f]),s=x in e?String(e[x]).trim():"";s||(s=td);let l=String(e[p]),o=H(l);if(!r||isNaN(a)||a<=0||!o){console.warn("Fila ".concat(t+2," omitida: Datos inv\xe1lidos (Producto: ").concat(r,", Precio: ").concat(a,", Fecha y Hora: ").concat(l,")")),j++;return}let n={id:(0,ts.A)(),product:r,price:a,category:s||td,timestamp:o};h.push(n),n.category!==td&&g.add(n.category)}),h.length>0?(r(e=>[...e,...h].sort((e,t)=>{var r,a,s,l;let o=null!=(s=null==(r=H(e.timestamp))?void 0:r.getTime())?s:0;return(null!=(l=null==(a=H(t.timestamp))?void 0:a.getTime())?l:0)-o})),n(Array.from(g).sort()),e({title:"Importaci\xf3n Exitosa",description:"".concat(h.length," gastos importados. Se omitieron ").concat(j," filas debido a errores o datos faltantes.")})):j>0?e({title:"Error de Importaci\xf3n",description:"No se importaron gastos. Se omitieron ".concat(j," filas debido a errores o datos faltantes."),variant:"destructive"}):e({title:"Error de Importaci\xf3n",description:"No se encontraron datos de gastos v\xe1lidos en el archivo.",variant:"destructive"})}catch(t){console.error("Error al importar archivo:",t),e({title:"Error de Importaci\xf3n",description:"Ocurri\xf3 un error al importar el archivo. Por favor, verifica el formato del archivo e int\xe9ntalo de nuevo.",variant:"destructive"})}finally{c.current&&(c.current.value="")}},i.readAsBinaryString(s)},accept:".xlsx, .xls",style:{display:"none"}})]}),!i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(f,{variant:"outline",disabled:!0,children:[(0,a.jsx)(tl.A,{className:"mr-2 h-4 w-4"})," Exportar a Excel"]}),(0,a.jsxs)(f,{variant:"outline",disabled:!0,children:[(0,a.jsx)(to.A,{className:"mr-2 h-4 w-4"})," Importar desde Excel"]})]})]})]})})]})]})]})}},16760:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8104)}])},32383:()=>{},83686:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[509,848,636,593,792],()=>t(16760)),_N_E=e.O()}]);